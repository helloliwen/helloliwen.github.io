!function s(o,a,u){function c(n,e){if(!a[n]){if(!o[n]){var t="function"==typeof require&&require;if(!e&&t)return t(n,!0);if(l)return l(n,!0);var r=new Error("Cannot find module '"+n+"'");throw r.code="MODULE_NOT_FOUND",r}var i=a[n]={exports:{}};o[n][0].call(i.exports,function(e){var t=o[n][1][e];return c(t||e)},i,i.exports,s,o,a,u)}return a[n].exports}for(var l="function"==typeof require&&require,e=0;e<u.length;e++)c(u[e]);return c}({1:[function(e,t){"use strict";var s=e("underscore");t.exports=function(i){var t="*";i.ACL=function(e){var r=this;if(r.permissionsById={},s.isObject(e))if(e instanceof i.User)r.setReadAccess(e,!0),r.setWriteAccess(e,!0);else{if(s.isFunction(e))throw"AV.ACL() called with a function.  Did you forget ()?";i._objectEach(e,function(e,n){if(!s.isString(n))throw"Tried to create an ACL with an invalid userId.";r.permissionsById[n]={},i._objectEach(e,function(e,t){if("read"!==t&&"write"!==t)throw"Tried to create an ACL with an invalid permission type.";if(!s.isBoolean(e))throw"Tried to create an ACL with an invalid permission value.";r.permissionsById[n][t]=e})})}},i.ACL.prototype.toJSON=function(){return s.clone(this.permissionsById)},i.ACL.prototype._setAccess=function(e,t,n){if(t instanceof i.User?t=t.id:t instanceof i.Role&&(t="role:"+t.getName()),!s.isString(t))throw"userId must be a string.";if(!s.isBoolean(n))throw"allowed must be either true or false.";var r=this.permissionsById[t];if(!r){if(!n)return;r={},this.permissionsById[t]=r}n?this.permissionsById[t][e]=!0:(delete r[e],s.isEmpty(r)&&delete r[t])},i.ACL.prototype._getAccess=function(e,t){t instanceof i.User?t=t.id:t instanceof i.Role&&(t="role:"+t.getName());var n=this.permissionsById[t];return!(!n||!n[e])},i.ACL.prototype.setReadAccess=function(e,t){this._setAccess("read",e,t)},i.ACL.prototype.getReadAccess=function(e){return this._getAccess("read",e)},i.ACL.prototype.setWriteAccess=function(e,t){this._setAccess("write",e,t)},i.ACL.prototype.getWriteAccess=function(e){return this._getAccess("write",e)},i.ACL.prototype.setPublicReadAccess=function(e){this.setReadAccess(t,e)},i.ACL.prototype.getPublicReadAccess=function(){return this.getReadAccess(t)},i.ACL.prototype.setPublicWriteAccess=function(e){this.setWriteAccess(t,e)},i.ACL.prototype.getPublicWriteAccess=function(){return this.getWriteAccess(t)},i.ACL.prototype.getRoleReadAccess=function(e){if(e instanceof i.Role&&(e=e.getName()),s.isString(e))return this.getReadAccess("role:"+e);throw"role must be a AV.Role or a String"},i.ACL.prototype.getRoleWriteAccess=function(e){if(e instanceof i.Role&&(e=e.getName()),s.isString(e))return this.getWriteAccess("role:"+e);throw"role must be a AV.Role or a String"},i.ACL.prototype.setRoleReadAccess=function(e,t){if(e instanceof i.Role&&(e=e.getName()),!s.isString(e))throw"role must be a AV.Role or a String";this.setReadAccess("role:"+e,t)},i.ACL.prototype.setRoleWriteAccess=function(e,t){if(e instanceof i.Role&&(e=e.getName()),!s.isString(e))throw"role must be a AV.Role or a String";this.setWriteAccess("role:"+e,t)}}},{underscore:29}],2:[function(n){(function(e){var t={};t._=n("underscore"),t.VERSION=n("./version"),t.Promise=n("./promise"),t.XMLHttpRequest=n("xmlhttprequest").XMLHttpRequest,t.localStorage=n("localStorage"),n("./utils")(t),n("./error")(t),n("./event")(t),n("./geopoint")(t),n("./acl")(t),n("./op")(t),n("./relation")(t),n("./file")(t),n("./object")(t),n("./role")(t),n("./user")(t),n("./query")(t),n("./cloudfunction")(t),n("./push")(t),n("./status")(t),n("./search")(t),n("./insight")(t),n("./bigquery")(t),e.AV=t}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./acl":1,"./bigquery":3,"./cloudfunction":8,"./error":9,"./event":10,"./file":11,"./geopoint":12,"./insight":13,"./object":14,"./op":15,"./promise":16,"./push":17,"./query":18,"./relation":19,"./role":20,"./search":21,"./status":22,"./user":23,"./utils":24,"./version":25,localStorage:4,underscore:29,xmlhttprequest:7}],3:[function(e,t){"use strict";t.exports=function(e){Object.defineProperty(e,"BigQuery",{get:function(){return console.warn("AV.BigQuery is deprecated, please use AV.Insight instead."),e.Insight}})}},{}],4:[function(r,i){(function(e){"use strict";var t=e.localStorage;try{var n="__storejs__";if(t.setItem(n,n),t.getItem(n)!=n)throw new Error;t.removeItem(n)}catch(e){t=r("localstorage-memory")}i.exports=t}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"localstorage-memory":28}],5:[function(e,t){"use strict";t.exports=function(e,t){var n;n=e.indexOf("base64")<0?atob(e):0<=e.split(",")[0].indexOf("base64")?atob(e.split(",")[1]):unescape(e.split(",")[1]);for(var r=t||e.split(",")[0].split(":")[1].split(";")[0],i=new Uint8Array(n.length),s=0;s<n.length;s++)i[s]=n.charCodeAt(s);return new Blob([i],{type:r})}},{}],6:[function(e,t){"use strict";t.exports=function(e,o,a){var u,c=e;c._previousSave=c._source.then(function(e,t){return u=e,c._qiniuToken(t)}).then(function(e){c._url=e.url,c._bucket=e.bucket,c.id=e.objectId;var t=e.token,n=new FormData;n.append("file",u,c._name),n.append("key",c._qiniu_key),n.append("token",t);var r=new o.Promise,i=!1,s=new o.XMLHttpRequest;return s.upload.addEventListener("progress",function(e){e.lengthComputable&&a.onProgress&&a.onProgress(e)},!1),s.onreadystatechange=function(){if(4===s.readyState){if(i)return;if(i=!0,delete c._qiniu_key,200<=s.status&&s.status<300){var e;try{e=JSON.parse(s.responseText)}catch(e){r.reject(e),c.destroy()}e?r.resolve(c):r.reject(e)}else r.reject(s),c.destroy()}},s.open("POST","http://upload.qiniu.com",!0),s.send(n),r})}},{}],7:[function(e,t,n){(function(e){"use strict";n.XMLHttpRequest=e.XMLHttpRequest}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(e,t){"use strict";var n=e("underscore");t.exports=function(i){i.Cloud=i.Cloud||{},n.extend(i.Cloud,{run:function(e,t,n){return i._request("functions",e,null,"POST",i._encode(t,null,!0)).then(function(e){return i._decode(null,e).result})._thenRunCallbacks(n)},getServerDate:function(e){return i._request("date",null,null,"GET").then(function(e){return i._decode(null,e)})._thenRunCallbacks(e)},requestSmsCode:function(e,t){if(n.isString(e)&&(e={mobilePhoneNumber:e}),!e.mobilePhoneNumber)throw"Missing mobilePhoneNumber.";return i._request("requestSmsCode",null,null,"POST",e)._thenRunCallbacks(t)},verifySmsCode:function(e,t,n){if(!e)throw"Missing sms code.";var r={};return i._.isString(t)?r.mobilePhoneNumber=t:n=t,i._request("verifySmsCode",e,null,"POST",r)._thenRunCallbacks(n)}})}},{underscore:29}],9:[function(e,t){"use strict";var n=e("underscore");t.exports=function(e){e.Error=function(e,t){this.code=e,this.message=t},n.extend(e.Error,{OTHER_CAUSE:-1,INTERNAL_SERVER_ERROR:1,CONNECTION_FAILED:100,OBJECT_NOT_FOUND:101,INVALID_QUERY:102,INVALID_CLASS_NAME:103,MISSING_OBJECT_ID:104,INVALID_KEY_NAME:105,INVALID_POINTER:106,INVALID_JSON:107,COMMAND_UNAVAILABLE:108,NOT_INITIALIZED:109,INCORRECT_TYPE:111,INVALID_CHANNEL_NAME:112,PUSH_MISCONFIGURED:115,OBJECT_TOO_LARGE:116,OPERATION_FORBIDDEN:119,CACHE_MISS:120,INVALID_NESTED_KEY:121,INVALID_FILE_NAME:122,INVALID_ACL:123,TIMEOUT:124,INVALID_EMAIL_ADDRESS:125,MISSING_CONTENT_TYPE:126,MISSING_CONTENT_LENGTH:127,INVALID_CONTENT_LENGTH:128,FILE_TOO_LARGE:129,FILE_SAVE_ERROR:130,FILE_DELETE_ERROR:153,DUPLICATE_VALUE:137,INVALID_ROLE_NAME:139,EXCEEDED_QUOTA:140,SCRIPT_FAILED:141,VALIDATION_ERROR:142,INVALID_IMAGE_DATA:150,UNSAVED_FILE_ERROR:151,INVALID_PUSH_TIME_ERROR:152,USERNAME_MISSING:200,PASSWORD_MISSING:201,USERNAME_TAKEN:202,EMAIL_TAKEN:203,EMAIL_MISSING:204,EMAIL_NOT_FOUND:205,SESSION_MISSING:206,MUST_CREATE_USER_THROUGH_SIGNUP:207,ACCOUNT_ALREADY_LINKED:208,LINKED_ID_MISSING:250,INVALID_LINKED_SESSION:251,UNSUPPORTED_SERVICE:252,X_DOMAIN_REQUEST:602})}},{underscore:29}],10:[function(e,t){t.exports=function(e){var c=/\s+/,u=Array.prototype.slice;e.Events={on:function(e,t,n){var r,i,s,o,a;if(!t)return this;for(e=e.split(c),r=this._callbacks||(this._callbacks={}),i=e.shift();i;)(s=(a=r[i])?a.tail:{}).next=o={},s.context=n,s.callback=t,r[i]={tail:o,next:a?a.next:s},i=e.shift();return this},off:function(e,t,n){var r,i,s,o,a,u;if(i=this._callbacks){if(!(e||t||n))return delete this._callbacks,this;for(r=(e=e?e.split(c):_.keys(i)).shift();r;)if(s=i[r],delete i[r],s&&(t||n)){for(o=s.tail,s=s.next;s!==o;)a=s.callback,u=s.context,(t&&a!==t||n&&u!==n)&&this.on(r,a,u),s=s.next;r=e.shift()}return this}},trigger:function(e){var t,n,r,i,s,o,a;if(!(r=this._callbacks))return this;for(o=r.all,e=e.split(c),a=u.call(arguments,1),t=e.shift();t;){if(n=r[t])for(i=n.tail;(n=n.next)!==i;)n.callback.apply(n.context||this,a);if(n=o)for(i=n.tail,s=[t].concat(a);(n=n.next)!==i;)n.callback.apply(n.context||this,s);t=e.shift()}return this}},e.Events.bind=e.Events.on,e.Events.unbind=e.Events.off}},{}],11:[function(f,e){(function(l){"use strict";var o=f("path"),h=f("underscore");e.exports=function(a){function u(e){if(e<26)return String.fromCharCode(65+e);if(e<52)return String.fromCharCode(e-26+97);if(e<62)return String.fromCharCode(e-52+48);if(62===e)return"+";if(63===e)return"/";throw"Tried to encode large digit "+e+" in base64."}var c={ai:"application/postscript",aif:"audio/x-aiff",aifc:"audio/x-aiff",aiff:"audio/x-aiff",asc:"text/plain",atom:"application/atom+xml",au:"audio/basic",avi:"video/x-msvideo",bcpio:"application/x-bcpio",bin:"application/octet-stream",bmp:"image/bmp",cdf:"application/x-netcdf",cgm:"image/cgm",class:"application/octet-stream",cpio:"application/x-cpio",cpt:"application/mac-compactpro",csh:"application/x-csh",css:"text/css",dcr:"application/x-director",dif:"video/x-dv",dir:"application/x-director",djv:"image/vnd.djvu",djvu:"image/vnd.djvu",dll:"application/octet-stream",dmg:"application/octet-stream",dms:"application/octet-stream",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",docm:"application/vnd.ms-word.document.macroEnabled.12",dotm:"application/vnd.ms-word.template.macroEnabled.12",dtd:"application/xml-dtd",dv:"video/x-dv",dvi:"application/x-dvi",dxr:"application/x-director",eps:"application/postscript",etx:"text/x-setext",exe:"application/octet-stream",ez:"application/andrew-inset",gif:"image/gif",gram:"application/srgs",grxml:"application/srgs+xml",gtar:"application/x-gtar",hdf:"application/x-hdf",hqx:"application/mac-binhex40",htm:"text/html",html:"text/html",ice:"x-conference/x-cooltalk",ico:"image/x-icon",ics:"text/calendar",ief:"image/ief",ifb:"text/calendar",iges:"model/iges",igs:"model/iges",jnlp:"application/x-java-jnlp-file",jp2:"image/jp2",jpe:"image/jpeg",jpeg:"image/jpeg",jpg:"image/jpeg",js:"application/x-javascript",kar:"audio/midi",latex:"application/x-latex",lha:"application/octet-stream",lzh:"application/octet-stream",m3u:"audio/x-mpegurl",m4a:"audio/mp4a-latm",m4b:"audio/mp4a-latm",m4p:"audio/mp4a-latm",m4u:"video/vnd.mpegurl",m4v:"video/x-m4v",mac:"image/x-macpaint",man:"application/x-troff-man",mathml:"application/mathml+xml",me:"application/x-troff-me",mesh:"model/mesh",mid:"audio/midi",midi:"audio/midi",mif:"application/vnd.mif",mov:"video/quicktime",movie:"video/x-sgi-movie",mp2:"audio/mpeg",mp3:"audio/mpeg",mp4:"video/mp4",mpe:"video/mpeg",mpeg:"video/mpeg",mpg:"video/mpeg",mpga:"audio/mpeg",ms:"application/x-troff-ms",msh:"model/mesh",mxu:"video/vnd.mpegurl",nc:"application/x-netcdf",oda:"application/oda",ogg:"application/ogg",pbm:"image/x-portable-bitmap",pct:"image/pict",pdb:"chemical/x-pdb",pdf:"application/pdf",pgm:"image/x-portable-graymap",pgn:"application/x-chess-pgn",pic:"image/pict",pict:"image/pict",png:"image/png",pnm:"image/x-portable-anymap",pnt:"image/x-macpaint",pntg:"image/x-macpaint",ppm:"image/x-portable-pixmap",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",potx:"application/vnd.openxmlformats-officedocument.presentationml.template",ppsx:"application/vnd.openxmlformats-officedocument.presentationml.slideshow",ppam:"application/vnd.ms-powerpoint.addin.macroEnabled.12",pptm:"application/vnd.ms-powerpoint.presentation.macroEnabled.12",potm:"application/vnd.ms-powerpoint.template.macroEnabled.12",ppsm:"application/vnd.ms-powerpoint.slideshow.macroEnabled.12",ps:"application/postscript",qt:"video/quicktime",qti:"image/x-quicktime",qtif:"image/x-quicktime",ra:"audio/x-pn-realaudio",ram:"audio/x-pn-realaudio",ras:"image/x-cmu-raster",rdf:"application/rdf+xml",rgb:"image/x-rgb",rm:"application/vnd.rn-realmedia",roff:"application/x-troff",rtf:"text/rtf",rtx:"text/richtext",sgm:"text/sgml",sgml:"text/sgml",sh:"application/x-sh",shar:"application/x-shar",silo:"model/mesh",sit:"application/x-stuffit",skd:"application/x-koan",skm:"application/x-koan",skp:"application/x-koan",skt:"application/x-koan",smi:"application/smil",smil:"application/smil",snd:"audio/basic",so:"application/octet-stream",spl:"application/x-futuresplash",src:"application/x-wais-source",sv4cpio:"application/x-sv4cpio",sv4crc:"application/x-sv4crc",svg:"image/svg+xml",swf:"application/x-shockwave-flash",t:"application/x-troff",tar:"application/x-tar",tcl:"application/x-tcl",tex:"application/x-tex",texi:"application/x-texinfo",texinfo:"application/x-texinfo",tif:"image/tiff",tiff:"image/tiff",tr:"application/x-troff",tsv:"text/tab-separated-values",txt:"text/plain",ustar:"application/x-ustar",vcd:"application/x-cdlink",vrml:"model/vrml",vxml:"application/voicexml+xml",wav:"audio/x-wav",wbmp:"image/vnd.wap.wbmp",wbmxl:"application/vnd.wap.wbxml",wml:"text/vnd.wap.wml",wmlc:"application/vnd.wap.wmlc",wmls:"text/vnd.wap.wmlscript",wmlsc:"application/vnd.wap.wmlscriptc",wrl:"model/vrml",xbm:"image/x-xbitmap",xht:"application/xhtml+xml",xhtml:"application/xhtml+xml",xls:"application/vnd.ms-excel",xml:"application/xml",xpm:"image/x-xpixmap",xsl:"application/xml",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.12",xltm:"application/vnd.ms-excel.template.macroEnabled.12",xlam:"application/vnd.ms-excel.addin.macroEnabled.12",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.12",xslt:"application/xslt+xml",xul:"application/vnd.mozilla.xul+xml",xwd:"image/x-xwindowdump",xyz:"chemical/x-xyz",zip:"application/zip"};a.File=function(e,t,n){this._name=e;var r=a.User.current();this._metaData={owner:null!=r?r.id:"unknown"};var i=/\.([^.]*)$/.exec(e);i&&(i=i[1].toLowerCase());var s=n||c[i]||"text/plain";if(this._guessedType=s,h.isArray(t))this._source=a.Promise.as(function(o){var a=[];return a.length=Math.ceil(o.length/3),h.times(a.length,function(e){var t=o[3*e],n=o[3*e+1]||0,r=o[3*e+2]||0,i=3*e+1<o.length,s=3*e+2<o.length;a[e]=[u(t>>2&63),u(t<<4&48|n>>4&15),i?u(n<<2&60|r>>6&3):"=",s?u(63&r):"="].join("")}),a.join("")}(t),s),this._metaData.size=t.length;else if(t&&t.base64){var o=f("./browserify-wrapper/parse-base64")(t.base64,s);this._source=a.Promise.as(o,s)}else if(t&&t.blob)this._source=a.Promise.as(t.blob,s);else if("undefined"!=typeof File&&t instanceof File)this._source=a.Promise.as(t,s);else if(a._isNode&&l.Buffer.isBuffer(t))this._source=a.Promise.as(t.toString("base64"),s),this._metaData.size=t.length;else if(h.isString(t))throw"Creating a AV.File from a String is not yet supported."},a.File.withURL=function(e,t,n,r){if(!e||!t)throw"Please provide file name and url";var i=new a.File(e,null,r);if(n)for(var s in n)i._metaData[s]||(i._metaData[s]=n[s]);return i._url=t,i._metaData.__source="external",i},a.File.createWithoutData=function(e){var t=new a.File;return t.id=e,t},a.File.prototype={toJSON:function(){return a._encode(this)},getACL:function(){return this._acl},setACL:function(e){return e instanceof a.ACL?void(this._acl=e):new a.Error(a.Error.OTHER_CAUSE,"ACL must be a AV.ACL.")},name:function(){return this._name},url:function(){return this._url},metaData:function(e,t){return null!=e&&null!=t?(this._metaData[e]=t,this):null!=e?this._metaData[e]:this._metaData},thumbnailURL:function(e,t,n,r,i){if(!this.url())throw"Invalid url.";if(!e||!t||e<=0||t<=0)throw"Invalid width or height value.";if((n=n||100)<=0||100<n)throw"Invalid quality value.";i=i||"png";var s=(r=null==r||r)?2:1;return this.url()+"?imageView/"+s+"/w/"+e+"/h/"+t+"/q/"+n+"/format/"+i},size:function(){return this.metaData().size},ownerId:function(){return this.metaData().owner},destroy:function(e){return this.id?a._request("files",null,this.id,"DELETE")._thenRunCallbacks(e):a.Promise.error("The file id is not eixsts.")._thenRunCallbacks(e)},_qiniuToken:function(e){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}var n=this,r=o.extname(n._name),i=t()+t()+t()+t()+t()+r,s={key:i,ACL:n._acl,name:n._name,mime_type:e,metaData:n._metaData};return e&&null==n._metaData.mime_type&&(n._metaData.mime_type=e),n._qiniu_key=i,a._request("qiniu",null,null,"POST",s)},save:function(){var e=null,t={};1===arguments.length?e=arguments[0]:2===arguments.length&&(t=arguments[0],e=arguments[1]);var n=this;if(!n._previousSave)if(n._source){f("./browserify-wrapper/upload")(n,a,t)}else if(n._url&&"external"==n._metaData.__source){var r={name:n._name,ACL:n._acl,metaData:n._metaData,mime_type:n._guessedType,url:n._url};n._previousSave=a._request("files",n._name,null,"POST",r).then(function(e){return n._name=e.name,n._url=e.url,n.id=e.objectId,e.size&&(n._metaData.size=e.size),n})}return n._previousSave._thenRunCallbacks(e)}}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./browserify-wrapper/parse-base64":5,"./browserify-wrapper/upload":6,path:26,underscore:29}],12:[function(e,t){var i=e("underscore");t.exports=function(r){r.GeoPoint=function(e,t){i.isArray(e)?(r.GeoPoint._validate(e[0],e[1]),this.latitude=e[0],this.longitude=e[1]):i.isObject(e)?(r.GeoPoint._validate(e.latitude,e.longitude),this.latitude=e.latitude,this.longitude=e.longitude):i.isNumber(e)&&i.isNumber(t)?(r.GeoPoint._validate(e,t),this.latitude=e,this.longitude=t):(this.latitude=0,this.longitude=0);var n=this;this.__defineGetter__&&this.__defineSetter__&&(this._latitude=this.latitude,this._longitude=this.longitude,this.__defineGetter__("latitude",function(){return n._latitude}),this.__defineGetter__("longitude",function(){return n._longitude}),this.__defineSetter__("latitude",function(e){r.GeoPoint._validate(e,n.longitude),n._latitude=e}),this.__defineSetter__("longitude",function(e){r.GeoPoint._validate(n.latitude,e),n._longitude=e}))},r.GeoPoint._validate=function(e,t){if(e<-90)throw"AV.GeoPoint latitude "+e+" < -90.0.";if(90<e)throw"AV.GeoPoint latitude "+e+" > 90.0.";if(t<-180)throw"AV.GeoPoint longitude "+t+" < -180.0.";if(180<t)throw"AV.GeoPoint longitude "+t+" > 180.0."},r.GeoPoint.current=function(e){var t=new r.Promise;return navigator.geolocation.getCurrentPosition(function(e){t.resolve(new r.GeoPoint({latitude:e.coords.latitude,longitude:e.coords.longitude}))},function(e){t.reject(e)}),t._thenRunCallbacks(e)},r.GeoPoint.prototype={toJSON:function(){return r.GeoPoint._validate(this.latitude,this.longitude),{__type:"GeoPoint",latitude:this.latitude,longitude:this.longitude}},radiansTo:function(e){var t=Math.PI/180,n=this.latitude*t,r=this.longitude*t,i=e.latitude*t,s=n-i,o=r-e.longitude*t,a=Math.sin(s/2),u=Math.sin(o/2),c=a*a+Math.cos(n)*Math.cos(i)*u*u;return c=Math.min(1,c),2*Math.asin(Math.sqrt(c))},kilometersTo:function(e){return 6371*this.radiansTo(e)},milesTo:function(e){return 3958.8*this.radiansTo(e)}}}},{underscore:29}],13:[function(e,t){"use strict";var n=e("underscore");t.exports=function(r){r.Insight=r.Insight||{},n.extend(r.Insight,{startJob:function(e,t){if(!e||!e.sql)throw new Error("Please provide the sql to run the job.");var n={jobConfig:e,appId:r.applicationId};return r._request("bigquery","jobs",null,"POST",r._encode(n,null,!0)).then(function(e){return r._decode(null,e).id})._thenRunCallbacks(t)},on:function(){}}),r.Insight.JobQuery=function(e,t){if(!e)throw new Error("Please provide the job id.");this.id=e,this.className=t,this._skip=0,this._limit=100},r.Insight.JobQuery.prototype={skip:function(e){return this._skip=e,this},limit:function(e){return this._limit=e,this},find:function(e){var t={skip:this._skip,limit:this._limit};return r._request("bigquery","jobs",this.id,"GET",t).then(function(e){return e.error?r.Promise.error(new r.Error(e.code,e.error)):r.Promise.as(e)})._thenRunCallbacks(e)}}}},{underscore:29}],14:[function(e,t){"use strict";var d=e("underscore");t.exports=function(f){f.Object=function(e,t){if(d.isString(e))return f.Object._create.apply(this,arguments);e=e||{},t&&t.parse&&(e=this.parse(e));var n=f._getValue(this,"defaults");if(n&&(e=d.extend({},n,e)),t&&t.collection&&(this.collection=t.collection),this._serverData={},this._opSetQueue=[{}],this.attributes={},this._hashedJSON={},this._escapedAttributes={},this.cid=d.uniqueId("c"),this.changed={},this._silent={},this._pending={},!this.set(e,{silent:!0}))throw new Error("Can't create an invalid AV.Object");this.changed={},this._silent={},this._pending={},this._hasData=!0,this._previousAttributes=d.clone(this.attributes),this.initialize.apply(this,arguments)},f.Object.saveAll=function(e,t){return f.Object._deepSaveAsync(e)._thenRunCallbacks(t)},d.extend(f.Object.prototype,f.Events,{_existed:!1,_fetchWhenSave:!1,initialize:function(){},fetchWhenSave:function(e){if(!d.isBoolean(e))throw"Expect boolean value for fetchWhenSave";this._fetchWhenSave=e},getObjectId:function(){return this.id},getCreatedAt:function(){return this.createdAt||this.get("createdAt")},getUpdatedAt:function(){return this.updatedAt||this.get("updatedAt")},toJSON:function(){var t=this._toFullJSON();return f._arrayEach(["__type","className"],function(e){delete t[e]}),t},_toFullJSON:function(n){var r=d.clone(this.attributes);return f._objectEach(r,function(e,t){r[t]=f._encode(e,n)}),f._objectEach(this._operations,function(e,t){r[t]=e}),d.has(this,"id")&&(r.objectId=this.id),d.has(this,"createdAt")&&(r.createdAt=d.isDate(this.createdAt)?this.createdAt.toJSON():this.createdAt),d.has(this,"updatedAt")&&(r.updatedAt=d.isDate(this.updatedAt)?this.updatedAt.toJSON():this.updatedAt),r.__type="Object",r.className=this.className,r},_refreshCache:function(){var n=this;n._refreshingCache||(n._refreshingCache=!0,f._objectEach(this.attributes,function(e,t){e instanceof f.Object?e._refreshCache():d.isObject(e)&&n._resetCacheForKey(t)&&n.set(t,new f.Op.Set(e),{silent:!0})}),delete n._refreshingCache)},dirty:function(e){this._refreshCache();var t=d.last(this._opSetQueue);return e?!!t[e]:!this.id||0<d.keys(t).length},_toPointer:function(){return{__type:"Pointer",className:this.className,objectId:this.id}},get:function(e){return this.attributes[e]},relation:function(e){var t=this.get(e);if(t){if(!(t instanceof f.Relation))throw"Called relation() on non-relation field "+e;return t._ensureParentAndKey(this,e),t}return new f.Relation(this,e)},escape:function(e){var t=this._escapedAttributes[e];if(t)return t;var n,r=this.attributes[e];return n=f._isNullOrUndefined(r)?"":d.escape(r.toString()),this._escapedAttributes[e]=n},has:function(e){return!f._isNullOrUndefined(this.attributes[e])},_mergeMagicFields:function(t){var n=this;f._arrayEach(["id","objectId","createdAt","updatedAt"],function(e){t[e]&&("objectId"===e?n.id=t[e]:n[e]="createdAt"!==e&&"updatedAt"!==e||d.isDate(t[e])?t[e]:f._parseDate(t[e]),delete t[e])})},_startSave:function(){this._opSetQueue.push({})},_cancelSave:function(){var i=d.first(this._opSetQueue);this._opSetQueue=d.rest(this._opSetQueue);var s=d.first(this._opSetQueue);f._objectEach(i,function(e,t){var n=i[t],r=s[t];n&&r?s[t]=r._mergeWithPrevious(n):n&&(s[t]=n)}),this._saving=this._saving-1},_finishSave:function(e){var r={};f._traverse(this.attributes,function(e){e instanceof f.Object&&e.id&&e._hasData&&(r[e.id]=e)});var t=d.first(this._opSetQueue);this._opSetQueue=d.rest(this._opSetQueue),this._applyOpSet(t,this._serverData),this._mergeMagicFields(e);var i=this;f._objectEach(e,function(e,t){i._serverData[t]=f._decode(t,e);var n=f._traverse(i._serverData[t],function(e){return e instanceof f.Object&&r[e.id]?r[e.id]:void 0});n&&(i._serverData[t]=n)}),this._rebuildAllEstimatedData(),this._saving=this._saving-1},_finishFetch:function(e,t){this._opSetQueue=[{}],this._mergeMagicFields(e);var n=this;f._objectEach(e,function(e,t){n._serverData[t]=f._decode(t,e)}),this._rebuildAllEstimatedData(),this._refreshCache(),this._opSetQueue=[{}],this._hasData=t},_applyOpSet:function(e,n){var r=this;f._objectEach(e,function(e,t){n[t]=e._estimate(n[t],r,t),n[t]===f.Op._UNSET&&delete n[t]})},_resetCacheForKey:function(e){var t=this.attributes[e];if(!(!d.isObject(t)||t instanceof f.Object||t instanceof f.File)){t=t.toJSON?t.toJSON():t;var n=JSON.stringify(t);if(this._hashedJSON[e]!==n){var r=!!this._hashedJSON[e];return this._hashedJSON[e]=n,r}}return!1},_rebuildEstimatedDataForKey:function(n){var r=this;delete this.attributes[n],this._serverData[n]&&(this.attributes[n]=this._serverData[n]),f._arrayEach(this._opSetQueue,function(e){var t=e[n];t&&(r.attributes[n]=t._estimate(r.attributes[n],r,n),r.attributes[n]===f.Op._UNSET?delete r.attributes[n]:r._resetCacheForKey(n))})},_rebuildAllEstimatedData:function(){var n=this,r=d.clone(this.attributes);this.attributes=d.clone(this._serverData),f._arrayEach(this._opSetQueue,function(e){n._applyOpSet(e,n.attributes),f._objectEach(e,function(e,t){n._resetCacheForKey(t)})}),f._objectEach(r,function(e,t){n.attributes[t]!==e&&n.trigger("change:"+t,n,n.attributes[t],{})}),f._objectEach(this.attributes,function(e,t){d.has(r,t)||n.trigger("change:"+t,n,e,{})})},set:function(e,t,i){var s;if(d.isObject(e)||f._isNullOrUndefined(e)?(s=e,f._objectEach(s,function(e,t){s[t]=f._decode(t,e)}),i=t):(s={})[e]=f._decode(e,t),i=i||{},!s)return this;s instanceof f.Object&&(s=s.attributes),i.unset&&f._objectEach(s,function(e,t){s[t]=new f.Op.Unset});var n=d.clone(s),o=this;if(f._objectEach(n,function(e,t){e instanceof f.Op&&(n[t]=e._estimate(o.attributes[t],o,t),n[t]===f.Op._UNSET&&delete n[t])}),!this._validate(s,i))return!1;this._mergeMagicFields(s),i.changes={};var a=this._escapedAttributes;return this._previousAttributes,f._arrayEach(d.keys(s),function(e){var t=s[e];t instanceof f.Relation&&(t.parent=o),t instanceof f.Op||(t=new f.Op.Set(t));var n=!0;t instanceof f.Op.Set&&d.isEqual(o.attributes[e],t.value)&&(n=!1),n&&(delete a[e],i.silent?o._silent[e]=!0:i.changes[e]=!0);var r=d.last(o._opSetQueue);r[e]=t._mergeWithPrevious(r[e]),o._rebuildEstimatedDataForKey(e),n?(o.changed[e]=o.attributes[e],i.silent||(o._pending[e]=!0)):(delete o.changed[e],delete o._pending[e])}),i.silent||this.change(i),this},unset:function(e,t){return(t=t||{}).unset=!0,this.set(e,null,t)},increment:function(e,t){return(d.isUndefined(t)||d.isNull(t))&&(t=1),this.set(e,new f.Op.Increment(t))},add:function(e,t){return this.set(e,new f.Op.Add([t]))},addUnique:function(e,t){return this.set(e,new f.Op.AddUnique([t]))},remove:function(e,t){return this.set(e,new f.Op.Remove([t]))},op:function(e){return d.last(this._opSetQueue)[e]},clear:function(e){(e=e||{}).unset=!0;var t=d.extend(this.attributes,this._operations);return this.set(t,e)},_getSaveJSON:function(){var n=d.clone(d.first(this._opSetQueue));return f._objectEach(n,function(e,t){n[t]=e.toJSON()}),n},_canBeSerialized:function(){return f.Object._canBeSerializedAsValue(this.attributes)},fetch:function(){var e=null,t={};1===arguments.length?e=arguments[0]:2===arguments.length&&(t=arguments[0],e=arguments[1]);var r=this;return f._request("classes",this.className,this.id,"GET",t).then(function(e,t,n){return r._finishFetch(r.parse(e,t,n),!0),r})._thenRunCallbacks(e,this)},save:function(e,t,n){var s,o,a;if(!(a=d.isObject(e)||f._isNullOrUndefined(e)?(s=e,t):((s={})[e]=t,n))&&s&&0===d.reject(s,function(e,t){return d.include(["success","error","wait"],t)}).length){var r=!0;if(d.has(s,"success")&&!d.isFunction(s.success)&&(r=!1),d.has(s,"error")&&!d.isFunction(s.error)&&(r=!1),r)return this.save(null,s)}(a=d.clone(a)||{}).wait&&(o=d.clone(this.attributes));var i,u=d.clone(a)||{};if(u.wait&&(u.silent=!0),u.error=function(e,t){i=t},s&&!this.set(s,u))return f.Promise.error(i)._thenRunCallbacks(a,this);var c=this;c._refreshCache();var l=[],h=[];return f.Object._findUnsavedChildren(c.attributes,l,h),0<l.length+h.length?f.Object._deepSaveAsync(this.attributes,c).then(function(){return c.save(null,a)},function(e){return f.Promise.error(e)._thenRunCallbacks(a,c)}):(this._startSave(),this._saving=(this._saving||0)+1,this._allPreviousSaves=this._allPreviousSaves||f.Promise.as(),this._allPreviousSaves=this._allPreviousSaves._continueWith(function(){var e=c.id?"PUT":"POST",t=c._getSaveJSON();c._fetchWhenSave&&(t._fetchWhenSave=!0);var n="classes",r=c.className;"_User"!==c.className||c.id||(n="users",r=null);var i=(a._makeRequest||f._request)(n,r,c.id,e,t);return i.then(function(e,t,n){var r=c.parse(e,t,n);return a.wait&&(r=d.extend(s||{},r)),c._finishSave(r),a.wait&&c.set(o,u),c},function(e){return c._cancelSave(),f.Promise.error(e)})._thenRunCallbacks(a,c)}),this._allPreviousSaves)},destroy:function(e){e=e||{};function t(){n.trigger("destroy",n,n.collection,e)}var n=this;return this.id?(e.wait||t(),f._request("classes",this.className,this.id,"DELETE").then(function(){return e.wait&&t(),n})._thenRunCallbacks(e,this)):t()},parse:function(e,t){var n=d.clone(e);return d(["createdAt","updatedAt"]).each(function(e){n[e]&&(n[e]=f._parseDate(n[e]))}),n.updatedAt||(n.updatedAt=n.createdAt),t&&(this._existed=201!==t),n},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.id},change:function(n){n=n||{};var e=this._changing;this._changing=!0;var r=this;f._objectEach(this._silent,function(e){r._pending[e]=!0});var t=d.extend({},n.changes,this._silent);if(this._silent={},f._objectEach(t,function(e,t){r.trigger("change:"+t,r,r.get(t),n)}),e)return this;for(var i=function(e,t){r._pending[t]||r._silent[t]||delete r.changed[t]};!d.isEmpty(this._pending);)this._pending={},this.trigger("change",this,n),f._objectEach(this.changed,i),r._previousAttributes=d.clone(this.attributes);return this._changing=!1,this},existed:function(){return this._existed},hasChanged:function(e){return arguments.length?this.changed&&d.has(this.changed,e):!d.isEmpty(this.changed)},changedAttributes:function(e){if(!e)return!!this.hasChanged()&&d.clone(this.changed);var n={},r=this._previousAttributes;return f._objectEach(e,function(e,t){d.isEqual(r[t],e)||(n[t]=e)}),n},previous:function(e){return arguments.length&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return d.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},validate:function(e){return!(!d.has(e,"ACL")||e.ACL instanceof f.ACL)&&new f.Error(f.Error.OTHER_CAUSE,"ACL must be a AV.ACL.")},_validate:function(e,t){if(t.silent||!this.validate)return!0;e=d.extend({},this.attributes,e);var n=this.validate(e,t);return!n||(t&&t.error?t.error(this,n,t):this.trigger("error",this,n,t),!1)},getACL:function(){return this.get("ACL")},setACL:function(e,t){return this.set("ACL",e,t)}}),f.Object.createWithoutData=function(e,t,n){var r=new f.Object(e);return r.id=t,r._hasData=n,r},f.Object.destroyAll=function(e,t){if(null==e||0==e.length)return f.Promise.as()._thenRunCallbacks(t);var n=e[0].className,r="",i=!0;return e.forEach(function(e){if(e.className!=n)throw"AV.Object.destroyAll requires the argument object array's classNames must be the same";if(!e.id)throw"Could not delete unsaved object";i?(r=e.id,i=!1):r=r+","+e.id}),f._request("classes",n,r,"DELETE")._thenRunCallbacks(t)},f.Object._getSubclass=function(e){if(!d.isString(e))throw"AV.Object._getSubclass requires a string argument.";var t=f.Object._classMap[e];return t||(t=f.Object.extend(e),f.Object._classMap[e]=t),t},f.Object._create=function(e,t,n){return new(f.Object._getSubclass(e))(t,n)},f.Object._classMap={},f.Object._extend=f._extend,f.Object.new=function(e,t){return new f.Object(e,t)},f.Object.extend=function(n,e,t){if(!d.isString(n)){if(n&&d.has(n,"className"))return f.Object.extend(n.className,n,e);throw new Error("AV.Object.extend's first argument should be the className.")}"User"===n&&(n="_User");var r=null;if(d.has(f.Object._classMap,n)){var i=f.Object._classMap[n];r=i._extend(e,t)}else(e=e||{}).className=n,r=this._extend(e,t);return r.extend=function(e){if(d.isString(e)||e&&d.has(e,"className"))return f.Object.extend.apply(r,arguments);var t=[n].concat(f._.toArray(arguments));return f.Object.extend.apply(r,t)},r.new=function(e,t){return new r(e,t)},f.Object._classMap[n]=r},f.Object._findUnsavedChildren=function(e,t,n){f._traverse(e,function(e){return e instanceof f.Object?(e._refreshCache(),void(e.dirty()&&t.push(e))):e instanceof f.File?void(e.url()||e.id||n.push(e)):void 0})},f.Object._canBeSerializedAsValue=function(e){var t=!0;return e instanceof f.Object||e instanceof f.File?t=!!e.id:d.isArray(e)?f._arrayEach(e,function(e){f.Object._canBeSerializedAsValue(e)||(t=!1)}):d.isObject(e)&&f._objectEach(e,function(e){f.Object._canBeSerializedAsValue(e)||(t=!1)}),t},f.Object._deepSaveAsync=function(e,t){var n=[],r=[];f.Object._findUnsavedChildren(e,n,r),t&&(n=d.filter(n,function(e){return e!=t}));var i=f.Promise.as();d.each(r,function(e){i=i.then(function(){return e.save()})});var s=d.uniq(n),o=d.uniq(s);return i.then(function(){return f.Promise._continueWhile(function(){return 0<o.length},function(){var t=[],n=[];if(f._arrayEach(o,function(e){return 20<t.length?void n.push(e):void(e._canBeSerialized()?t.push(e):n.push(e))}),o=n,0===t.length)return f.Promise.error(new f.Error(f.Error.OTHER_CAUSE,"Tried to save a batch with a cycle."));var e=f.Promise.when(d.map(t,function(e){return e._allPreviousSaves||f.Promise.as()})),r=new f.Promise;return f._arrayEach(t,function(e){e._allPreviousSaves=r}),e._continueWith(function(){return f._request("batch",null,null,"POST",{requests:d.map(t,function(e){var t=e._getSaveJSON(),n="POST",r="/1.1/classes/"+e.className;return e.id&&(r=r+"/"+e.id,n="PUT"),e._startSave(),{method:n,path:r,body:t}})}).then(function(n,r,i){var s;return f._arrayEach(t,function(e,t){n[t].success?e._finishSave(e.parse(n[t].success,r,i)):(s=s||n[t].error,e._cancelSave())}),s?f.Promise.error(new f.Error(s.code,s.error)):void 0}).then(function(e){return r.resolve(e),e},function(e){return r.reject(e),f.Promise.error(e)})})})}).then(function(){return e})}}},{underscore:29}],15:[function(e,t){"use strict";var s=e("underscore");t.exports=function(i){i.Op=function(){this._initialize.apply(this,arguments)},i.Op.prototype={_initialize:function(){}},s.extend(i.Op,{_extend:i._extend,_opDecoderMap:{},_registerDecoder:function(e,t){i.Op._opDecoderMap[e]=t},_decode:function(e){var t=i.Op._opDecoderMap[e.__op];return t?t(e):void 0}}),i.Op._registerDecoder("Batch",function(e){var t=null;return i._arrayEach(e.ops,function(e){e=i.Op._decode(e),t=e._mergeWithPrevious(t)}),t}),i.Op.Set=i.Op._extend({_initialize:function(e){this._value=e},value:function(){return this._value},toJSON:function(){return i._encode(this.value())},_mergeWithPrevious:function(){return this},_estimate:function(){return this.value()}}),i.Op._UNSET={},i.Op.Unset=i.Op._extend({toJSON:function(){return{__op:"Delete"}},_mergeWithPrevious:function(){return this},_estimate:function(){return i.Op._UNSET}}),i.Op._registerDecoder("Delete",function(){return new i.Op.Unset}),i.Op.Increment=i.Op._extend({_initialize:function(e){this._amount=e},amount:function(){return this._amount},toJSON:function(){return{__op:"Increment",amount:this._amount}},_mergeWithPrevious:function(e){if(e){if(e instanceof i.Op.Unset)return new i.Op.Set(this.amount());if(e instanceof i.Op.Set)return new i.Op.Set(e.value()+this.amount());if(e instanceof i.Op.Increment)return new i.Op.Increment(this.amount()+e.amount());throw"Op is invalid after previous op."}return this},_estimate:function(e){return e?e+this.amount():this.amount()}}),i.Op._registerDecoder("Increment",function(e){return new i.Op.Increment(e.amount)}),i.Op.Add=i.Op._extend({_initialize:function(e){this._objects=e},objects:function(){return this._objects},toJSON:function(){return{__op:"Add",objects:i._encode(this.objects())}},_mergeWithPrevious:function(e){if(e){if(e instanceof i.Op.Unset)return new i.Op.Set(this.objects());if(e instanceof i.Op.Set)return new i.Op.Set(this._estimate(e.value()));if(e instanceof i.Op.Add)return new i.Op.Add(e.objects().concat(this.objects()));throw"Op is invalid after previous op."}return this},_estimate:function(e){return e?e.concat(this.objects()):s.clone(this.objects())}}),i.Op._registerDecoder("Add",function(e){return new i.Op.Add(i._decode(void 0,e.objects))}),i.Op.AddUnique=i.Op._extend({_initialize:function(e){this._objects=s.uniq(e)},objects:function(){return this._objects},toJSON:function(){return{__op:"AddUnique",objects:i._encode(this.objects())}},_mergeWithPrevious:function(e){if(e){if(e instanceof i.Op.Unset)return new i.Op.Set(this.objects());if(e instanceof i.Op.Set)return new i.Op.Set(this._estimate(e.value()));if(e instanceof i.Op.AddUnique)return new i.Op.AddUnique(this._estimate(e.objects()));throw"Op is invalid after previous op."}return this},_estimate:function(e){if(e){var r=s.clone(e);return i._arrayEach(this.objects(),function(t){if(t instanceof i.Object&&t.id){var e=s.find(r,function(e){return e instanceof i.Object&&e.id===t.id});if(e){var n=s.indexOf(r,e);r[n]=t}else r.push(t)}else s.contains(r,t)||r.push(t)}),r}return s.clone(this.objects())}}),i.Op._registerDecoder("AddUnique",function(e){return new i.Op.AddUnique(i._decode(void 0,e.objects))}),i.Op.Remove=i.Op._extend({_initialize:function(e){this._objects=s.uniq(e)},objects:function(){return this._objects},toJSON:function(){return{__op:"Remove",objects:i._encode(this.objects())}},_mergeWithPrevious:function(e){if(e){if(e instanceof i.Op.Unset)return e;if(e instanceof i.Op.Set)return new i.Op.Set(this._estimate(e.value()));if(e instanceof i.Op.Remove)return new i.Op.Remove(s.union(e.objects(),this.objects()));throw"Op is invalid after previous op."}return this},_estimate:function(e){if(e){var n=s.difference(e,this.objects());return i._arrayEach(this.objects(),function(t){t instanceof i.Object&&t.id&&(n=s.reject(n,function(e){return e instanceof i.Object&&e.id===t.id}))}),n}return[]}}),i.Op._registerDecoder("Remove",function(e){return new i.Op.Remove(i._decode(void 0,e.objects))}),i.Op.Relation=i.Op._extend({_initialize:function(e,t){this._targetClassName=null;function n(e){if(e instanceof i.Object){if(!e.id)throw"You can't add an unsaved AV.Object to a relation.";if(r._targetClassName||(r._targetClassName=e.className),r._targetClassName!==e.className)throw"Tried to create a AV.Relation with 2 different types: "+r._targetClassName+" and "+e.className+".";return e.id}return e}var r=this;this.relationsToAdd=s.uniq(s.map(e,n)),this.relationsToRemove=s.uniq(s.map(t,n))},added:function(){var n=this;return s.map(this.relationsToAdd,function(e){var t=i.Object._create(n._targetClassName);return t.id=e,t})},removed:function(){var n=this;return s.map(this.relationsToRemove,function(e){var t=i.Object._create(n._targetClassName);return t.id=e,t})},toJSON:function(){function e(e){return{__type:"Pointer",className:r._targetClassName,objectId:e}}var t=null,n=null,r=this;return 0<this.relationsToAdd.length&&(t={__op:"AddRelation",objects:s.map(this.relationsToAdd,e)}),0<this.relationsToRemove.length&&(n={__op:"RemoveRelation",objects:s.map(this.relationsToRemove,e)}),t&&n?{__op:"Batch",ops:[t,n]}:t||n||{}},_mergeWithPrevious:function(e){if(e){if(e instanceof i.Op.Unset)throw"You can't modify a relation after deleting it.";if(e instanceof i.Op.Relation){if(e._targetClassName&&e._targetClassName!==this._targetClassName)throw"Related object must be of class "+e._targetClassName+", but "+this._targetClassName+" was passed in.";var t=s.union(s.difference(e.relationsToAdd,this.relationsToRemove),this.relationsToAdd),n=s.union(s.difference(e.relationsToRemove,this.relationsToAdd),this.relationsToRemove),r=new i.Op.Relation(t,n);return r._targetClassName=this._targetClassName,r}throw"Op is invalid after previous op."}return this},_estimate:function(e,t,n){if(e){if(e instanceof i.Relation){if(this._targetClassName)if(e.targetClassName){if(e.targetClassName!==this._targetClassName)throw"Related object must be a "+e.targetClassName+", but a "+this._targetClassName+" was passed in."}else e.targetClassName=this._targetClassName;return e}throw"Op is invalid after previous op."}new i.Relation(t,n).targetClassName=this._targetClassName}}),i.Op._registerDecoder("AddRelation",function(e){return new i.Op.Relation(i._decode(void 0,e.objects),[])}),i.Op._registerDecoder("RemoveRelation",function(e){return new i.Op.Relation([],i._decode(void 0,e.objects))})}},{underscore:29}],16:[function(t,n){(function(a){"use strict";function c(e){return l.isNull(e)||l.isUndefined(e)}var l=t("underscore"),h=n.exports=function(e){this._resolved=!1,this._rejected=!1,this._resolvedCallbacks=[],this._rejectedCallbacks=[],this.doResolve(e)},e=!1;void 0!==a&&a.versions&&a.versions.node&&(e=!0),l.extend(h,{_isPromisesAPlusCompliant:!e,_debugError:!1,setPromisesAPlusCompliant:function(e){h._isPromisesAPlusCompliant=e},setDebugError:function(e){h._debugError=e},is:function(e){return e&&e.then&&l.isFunction(e.then)},as:function(){var e=new h;return e.resolve.apply(e,arguments),e},error:function(){var e=new h;return e.reject.apply(e,arguments),e},when:function(e){var t;t=e&&c(e.length)?arguments:e;var n=l.last(arguments);n=!!l.isBoolean(n)&&n;var r=t.length,i=!1,s=[],o=[];if(s.length=t.length,o.length=t.length,0===r)return n?h.as.call(this,s):h.as.apply(this,s);function a(e){return r-=1,i&&!u._rejected&&n?void u.reject.call(u,o[e]):void(0===r&&(i&&!u._rejected?u.reject.call(u,o):n?u._rejected||u.resolve.call(u,s):u.resolve.apply(u,s)))}var u=new h;return l.each(t,function(e,t){h.is(e)?e.then(function(e){s[t]=e,a(t)},function(e){o[t]=e,i=!0,a(t)}):(s[t]=e,a(t))}),u},race:function(e){var t,n=(t=e&&c(e.length)?arguments:e).length,r=!1,i=[],s=[];if(i.length=s.length=t.length,0===n)return h.as.call(this);function o(e){a._resolved||a._rejected||(r?a.reject.call(a,s[e]):a.resolve.call(a,i[e]))}var a=new h;return l.each(t,function(e,t){h.is(e)?e.then(function(e){i[t]=e,o(t)},function(e){s[t]=e,r=!0,o(t)}):(i[t]=e,o(t))}),a},_continueWhile:function(e,t){return e()?t().then(function(){return h._continueWhile(e,t)}):h.as()}}),h.all=function(e){return h.when(e,!0)},l.extend(h.prototype,{resolve:function(){if(this._resolved||this._rejected)throw"A promise was resolved even though it had already been "+(this._resolved?"resolved":"rejected")+".";this._resolved=!0;var t=this._result=arguments;l.each(this._resolvedCallbacks,function(e){e.apply(this,t)}),this._resolvedCallbacks=[],this._rejectedCallbacks=[]},doResolve:function(e){if(e){var t=!1,n=this;try{e(function(e){t||(t=!0,n.resolve.call(n,e))},function(e){t||(t=!0,n.reject.call(n,e))})}catch(e){if(t)return;t=!0,n.reject.call(n,e)}}},reject:function(t){if(this._resolved||this._rejected)throw"A promise was rejected even though it had already been "+(this._resolved?"resolved":"rejected")+".";this._rejected=!0,this._error=t,l.each(this._rejectedCallbacks,function(e){e(t)}),this._resolvedCallbacks=[],this._rejectedCallbacks=[]},then:function(e,n){function t(){var t=arguments;if(e)if(h._isPromisesAPlusCompliant)try{t=[e.apply(this,t)]}catch(e){h._debugError&&e&&console.error("Error occurred in promise resolve callback.",e.stack||e),t=[h.error(e)]}else t=[e.apply(this,t)];1===t.length&&h.is(t[0])?t[0].then(function(){i.resolve.apply(i,arguments)},function(e){i.reject(e)}):i.resolve.apply(i,t)}function r(e){var t=[];if(n){if(h._isPromisesAPlusCompliant)try{t=[n(e)]}catch(e){h._debugError&&e&&console.error("Error occurred in promise reject callback.",e.stack||e),t=[h.error(e)]}else t=[n(e)];1===t.length&&h.is(t[0])?t[0].then(function(){i.resolve.apply(i,arguments)},function(e){i.reject(e)}):h._isPromisesAPlusCompliant?i.resolve.apply(i,t):i.reject(t[0])}else i.reject(e)}var i=new h,s=function(e){e.call()};h._isPromisesAPlusCompliant&&("undefined"!=typeof window&&l.isFunction(window.setImmediate)?s=function(e){window.setImmediate(e)}:void 0!==a&&a.nextTick?s=function(e){a.nextTick(e)}:"undefined"!=typeof setTimeout&&l.isFunction(setTimeout)&&(s=function(e){setTimeout(e,0)}));var o=this;return this._resolved?s(function(){t.apply(o,o._result)}):this._rejected?s(function(){r.apply(o,[o._error])}):(this._resolvedCallbacks.push(t),this._rejectedCallbacks.push(r)),i},catch:function(e){return this.then(void 0,e)},always:function(e){return this.then(e,e)},done:function(e){return this.then(e)},fail:function(e){return this.then(null,e)},_thenRunCallbacks:function(e,t){var n;if(l.isFunction(e)){var r=e;n={success:function(e){r(e,null)},error:function(e){r(null,e)}}}else n=l.clone(e);return n=n||{},this.then(function(e){return n.success?n.success.apply(this,arguments):t&&t.trigger("sync",t,e,n),h.as.apply(h,arguments)},function(e){return n.error?l.isUndefined(t)?n.error(e):n.error(t,e):t&&t.trigger("error",t,e,n),h.error(e)})},_continueWith:function(t){return this.then(function(){return t(arguments,null)},function(e){return t(null,e)})}}),h.prototype.finally=h.prototype.always,h.prototype.try=h.prototype.done}).call(this,t("_process"))},{_process:27,underscore:29}],17:[function(e,t){"use strict";t.exports=function(n){n.Installation=n.Object.extend("_Installation"),n.Push=n.Push||{},n.Push.send=function(e,t){if(e.where&&(e.where=e.where.toJSON().where),e.where&&e.cql)throw"Both where and cql can't be set";if(e.push_time&&(e.push_time=e.push_time.toJSON()),e.expiration_time&&(e.expiration_time=e.expiration_time.toJSON()),e.expiration_time&&e.expiration_time_interval)throw"Both expiration_time and expiration_time_interval can't be set";return n._request("push",null,null,"POST",e)._thenRunCallbacks(t)}}},{}],18:[function(e,t){"use strict";var o=e("underscore");t.exports=function(s){s.Query=function(e){o.isString(e)&&(e=s.Object._getSubclass(e)),this.objectClass=e,this.className=e.prototype.className,this._where={},this._include=[],this._limit=-1,this._skip=0,this._extraOptions={}},s.Query.or=function(){var e=o.toArray(arguments),t=null;s._arrayEach(e,function(e){if(o.isNull(t)&&(t=e.className),t!==e.className)throw"All queries must be for the same class"});var n=new s.Query(t);return n._orQuery(e),n},s.Query.and=function(){var e=o.toArray(arguments),t=null;s._arrayEach(e,function(e){if(o.isNull(t)&&(t=e.className),t!==e.className)throw"All queries must be for the same class"});var n=new s.Query(t);return n._andQuery(e),n},s.Query.doCloudQuery=function(e,t,n){var r={cql:e};return o.isArray(t)?r.pvalues=t:n=t,s._request("cloudQuery",null,null,"GET",r).then(function(n){var r=new s.Query(n.className);return{results:o.map(n.results,function(e){var t=r._newObject(n);return t._finishFetch(r._processResult(e),!0),t}),count:n.count,className:n.className}})._thenRunCallbacks(n)},s.Query._extend=s._extend,s.Query.prototype={_processResult:function(e){return e},get:function(e,t){if(!e){var n=new s.Error(s.Error.OBJECT_NOT_FOUND,"Object not found.");return s.Promise.error(n)}return this.equalTo("objectId",e),this.first().then(function(e){if(!s._.isEmpty(e))return e;var t=new s.Error(s.Error.OBJECT_NOT_FOUND,"Object not found.");return s.Promise.error(t)})._thenRunCallbacks(t,null)},toJSON:function(){var n={where:this._where};return 0<this._include.length&&(n.include=this._include.join(",")),this._select&&(n.keys=this._select.join(",")),0<=this._limit&&(n.limit=this._limit),0<this._skip&&(n.skip=this._skip),void 0!==this._order&&(n.order=this._order),s._objectEach(this._extraOptions,function(e,t){n[t]=e}),n},_newObject:function(e){return e&&e.className?new s.Object(e.className):new this.objectClass},_createRequest:function(e){return s._request("classes",this.className,null,"GET",e||this.toJSON())},find:function(e){var r=this;return this._createRequest().then(function(n){return o.map(n.results,function(e){var t=r._newObject(n);return t._finishFetch(r._processResult(e),!0),t})})._thenRunCallbacks(e)},destroyAll:function(e){return this.find().then(function(e){return s.Object.destroyAll(e)})._thenRunCallbacks(e)},count:function(e){var t=this.toJSON();return t.limit=0,t.count=1,this._createRequest(t).then(function(e){return e.count})._thenRunCallbacks(e)},first:function(e){var n=this,t=this.toJSON();return t.limit=1,this._createRequest(t).then(function(e){return o.map(e.results,function(e){var t=n._newObject();return t._finishFetch(n._processResult(e),!0),t})[0]})._thenRunCallbacks(e)},collection:function(e,t){return t=t||{},new s.Collection(e,o.extend(t,{model:this._objectClass||this.objectClass,query:this}))},skip:function(e){return this._skip=e,this},limit:function(e){return this._limit=e,this},equalTo:function(e,t){return this._where[e]=s._encode(t),this},_addCondition:function(e,t,n){return this._where[e]||(this._where[e]={}),this._where[e][t]=s._encode(n),this},sizeEqualTo:function(e,t){this._addCondition(e,"$size",t)},notEqualTo:function(e,t){return this._addCondition(e,"$ne",t),this},lessThan:function(e,t){return this._addCondition(e,"$lt",t),this},greaterThan:function(e,t){return this._addCondition(e,"$gt",t),this},lessThanOrEqualTo:function(e,t){return this._addCondition(e,"$lte",t),this},greaterThanOrEqualTo:function(e,t){return this._addCondition(e,"$gte",t),this},containedIn:function(e,t){return this._addCondition(e,"$in",t),this},notContainedIn:function(e,t){return this._addCondition(e,"$nin",t),this},containsAll:function(e,t){return this._addCondition(e,"$all",t),this},exists:function(e){return this._addCondition(e,"$exists",!0),this},doesNotExist:function(e){return this._addCondition(e,"$exists",!1),this},matches:function(e,t,n){return this._addCondition(e,"$regex",t),n||(n=""),t.ignoreCase&&(n+="i"),t.multiline&&(n+="m"),n&&n.length&&this._addCondition(e,"$options",n),this},matchesQuery:function(e,t){var n=t.toJSON();return n.className=t.className,this._addCondition(e,"$inQuery",n),this},doesNotMatchQuery:function(e,t){var n=t.toJSON();return n.className=t.className,this._addCondition(e,"$notInQuery",n),this},matchesKeyInQuery:function(e,t,n){var r=n.toJSON();return r.className=n.className,this._addCondition(e,"$select",{key:t,query:r}),this},doesNotMatchKeyInQuery:function(e,t,n){var r=n.toJSON();return r.className=n.className,this._addCondition(e,"$dontSelect",{key:t,query:r}),this},_orQuery:function(e){var t=o.map(e,function(e){return e.toJSON().where});return this._where.$or=t,this},_andQuery:function(e){var t=o.map(e,function(e){return e.toJSON().where});return this._where.$and=t,this},_quote:function(e){return"\\Q"+e.replace("\\E","\\E\\\\E\\Q")+"\\E"},contains:function(e,t){return this._addCondition(e,"$regex",this._quote(t)),this},startsWith:function(e,t){return this._addCondition(e,"$regex","^"+this._quote(t)),this},endsWith:function(e,t){return this._addCondition(e,"$regex",this._quote(t)+"$"),this},ascending:function(e){return this._order=e,this},addAscending:function(e){return this._order?this._order+=","+e:this._order=e,this},descending:function(e){return this._order="-"+e,this},addDescending:function(e){return this._order?this._order+=",-"+e:this._order="-"+e,e},near:function(e,t){return t instanceof s.GeoPoint||(t=new s.GeoPoint(t)),this._addCondition(e,"$nearSphere",t),this},withinRadians:function(e,t,n){return this.near(e,t),this._addCondition(e,"$maxDistance",n),this},withinMiles:function(e,t,n){return this.withinRadians(e,t,n/3958.8)},withinKilometers:function(e,t,n){return this.withinRadians(e,t,n/6371)},withinGeoBox:function(e,t,n){return t instanceof s.GeoPoint||(t=new s.GeoPoint(t)),n instanceof s.GeoPoint||(n=new s.GeoPoint(n)),this._addCondition(e,"$within",{$box:[t,n]}),this},include:function(){var t=this;return s._arrayEach(arguments,function(e){o.isArray(e)?t._include=t._include.concat(e):t._include.push(e)}),this},select:function(){var t=this;return this._select=this._select||[],s._arrayEach(arguments,function(e){o.isArray(e)?t._select=t._select.concat(e):t._select.push(e)}),this},each:function(n,e){if(e=e||{},this._order||this._skip||0<=this._limit){return s.Promise.error("Cannot iterate on a query with sort, skip, or limit.")._thenRunCallbacks(e)}var r=(new s.Promise,new s.Query(this.objectClass));r._limit=e.batchSize||100,r._where=o.clone(this._where),r._include=o.clone(this._include),r.ascending("objectId");var i=!1;return s.Promise._continueWhile(function(){return!i},function(){return r.find().then(function(e){var t=s.Promise.as();return s._.each(e,function(e){t=t.then(function(){return n(e)})}),t.then(function(){e.length>=r._limit?r.greaterThan("objectId",e[e.length-1].id):i=!0})})})._thenRunCallbacks(e)}},s.FriendShipQuery=s.Query._extend({_objectClass:s.User,_newObject:function(){return new s.User},_processResult:function(e){if(e&&e[this._friendshipTag]){var t=e[this._friendshipTag];return"Pointer"===t.__type&&"_User"===t.className&&(delete t.__type,delete t.className),t}return null}})}},{underscore:29}],19:[function(e,t){"use strict";var n=e("underscore");t.exports=function(i){i.Relation=function(e,t){if(!n.isString(t))throw new TypeError("key must be a string");this.parent=e,this.key=t,this.targetClassName=null},i.Relation.reverseQuery=function(e,t,n){var r=new i.Query(e);return r.equalTo(t,n._toPointer()),r},i.Relation.prototype={_ensureParentAndKey:function(e,t){if(this.parent=this.parent||e,this.key=this.key||t,this.parent!==e)throw"Internal Error. Relation retrieved from two different Objects.";if(this.key!==t)throw"Internal Error. Relation retrieved from two different keys."},add:function(e){n.isArray(e)||(e=[e]);var t=new i.Op.Relation(e,[]);this.parent.set(this.key,t),this.targetClassName=t._targetClassName},remove:function(e){n.isArray(e)||(e=[e]);var t=new i.Op.Relation([],e);this.parent.set(this.key,t),this.targetClassName=t._targetClassName},toJSON:function(){return{__type:"Relation",className:this.targetClassName}},query:function(){var e,t;return this.targetClassName?(e=i.Object._getSubclass(this.targetClassName),t=new i.Query(e)):(e=i.Object._getSubclass(this.parent.className),(t=new i.Query(e))._extraOptions.redirectClassNameForKey=this.key),t._addCondition("$relatedTo","object",this.parent._toPointer()),t._addCondition("$relatedTo","key",this.key),t}}}},{underscore:29}],20:[function(e,t){"use strict";var i=e("underscore");t.exports=function(r){r.Role=r.Object.extend("_Role",{constructor:function(e,t){if(i.isString(e)?(r.Object.prototype.constructor.call(this,null,null),this.setName(e)):r.Object.prototype.constructor.call(this,e,t),void 0===t){var n=new r.ACL;n.setPublicReadAccess(!0),this.getACL()||this.setACL(n)}else{if(!(t instanceof r.ACL))throw new TypeError("acl must be an instance of AV.ACL");this.setACL(t)}},getName:function(){return this.get("name")},setName:function(e,t){return this.set("name",e,t)},getUsers:function(){return this.relation("users")},getRoles:function(){return this.relation("roles")},validate:function(e,t){if("name"in e&&e.name!==this.getName()){var n=e.name;if(this.id&&this.id!==e.objectId)return new r.Error(r.Error.OTHER_CAUSE,"A role's name can only be set before it has been saved.");if(!i.isString(n))return new r.Error(r.Error.OTHER_CAUSE,"A role's name must be a String.");if(!/^[0-9a-zA-Z\-_ ]+$/.test(n))return new r.Error(r.Error.OTHER_CAUSE,"A role's name can only contain alphanumeric characters, _, -, and spaces.")}return!!r.Object.prototype.validate&&r.Object.prototype.validate.call(this,e,t)}})}},{underscore:29}],21:[function(e,t){"use strict";var i=e("underscore");t.exports=function(t){t.SearchSortBuilder=function(){this._sortFields=[]},t.SearchSortBuilder.prototype={_addField:function(e,t,n,r){var i={};return i[e]={order:t||"asc",mode:n||"avg",missing:"_"+(r||"last")},this._sortFields.push(i),this},ascending:function(e,t,n){return this._addField(e,"asc",t,n)},descending:function(e,t,n){return this._addField(e,"desc",t,n)},whereNear:function(e,t,n){n=n||{};var r={},i={lat:t.latitude,lon:t.longitude},s={order:n.order||"asc",mode:n.mode||"avg",unit:n.unit||"km"};return s[e]=i,r._geo_distance=s,this._sortFields.push(r),this},build:function(){return JSON.stringify(t._encode(this._sortFields))}},t.SearchQuery=t.Query._extend({_sid:null,_hits:0,_queryString:null,_highlights:null,_sortBuilder:null,_createRequest:function(e){return t._request("search/select",null,null,"GET",e||this.toJSON())},sid:function(e){return this._sid=e,this},queryString:function(e){return this._queryString=e,this},highlights:function(e){var t;return t=e&&i.isString(e)?arguments:e,this._highlights=t,this},sortBy:function(e){return this._sortBuilder=e,this},hits:function(){return this._hits||(this._hits=0),this._hits},_processResult:function(e){return delete e.className,delete e._app_url,delete e._deeplink,e},hasMore:function(){return!this._hitEnd},reset:function(){this._hitEnd=!1,this._sid=null,this._hits=0},find:function(e){var r=this;return this._createRequest().then(function(n){return n.sid?(r._oldSid=r._sid,r._sid=n.sid):(r._sid=null,r._hitEnd=!0),r._hits=n.hits||0,i.map(n.results,function(e){e.className&&(n.className=e.className);var t=r._newObject(n);return t.appURL=e._app_url,t._finishFetch(r._processResult(e),!0),t})})._thenRunCallbacks(e)},toJSON:function(){var e=t.SearchQuery.__super__.toJSON.call(this);if(delete e.where,this.className&&(e.clazz=this.className),this._sid&&(e.sid=this._sid),!this._queryString)throw"Please set query string.";if(e.q=this._queryString,this._highlights&&(e.highlights=this._highlights.join(",")),this._sortBuilder&&e.order)throw"sort and order can not be set at same time.";return this._sortBuilder&&(e.sort=this._sortBuilder.build()),e}})}},{underscore:29}],22:[function(e,t){"use strict";var u=e("underscore");t.exports=function(a){a.Status=function(e,t){return this.data={},this.inboxType="default",this.query=null,e&&"object"==typeof e?this.data=e:(e&&(this.data.image=e),t&&(this.data.message=t)),this},a.Status.prototype={get:function(e){return this.data[e]},set:function(e,t){return this.data[e]=t,this},destroy:function(e){return this.id?a._request("statuses",null,this.id,"DELETE")._thenRunCallbacks(e):a.Promise.error("The status id is not exists.")._thenRunCallbacks(e)},toObject:function(){return this.id?a.Object.createWithoutData("_Status",this.id):null},_getDataJSON:function(){var e=a._.clone(this.data);return a._encode(e)},send:function(e){if(!a.User.current())throw"Please signin an user.";if(!this.query)return a.Status.sendStatusToFollowers(this,e);var t=this.query.toJSON();t.className=this.query.className;var n={};n.query=t,this.data=this.data||{};var r=a.Object.createWithoutData("_User",a.User.current().id)._toPointer();this.data.source=this.data.source||r,n.data=this._getDataJSON(),n.inboxType=this.inboxType||"default";var i=a._request("statuses",null,null,"POST",n),s=this;return i.then(function(e){return s.id=e.objectId,s.createdAt=a._parseDate(e.createdAt),s})._thenRunCallbacks(e)},_finishFetch:function(e){this.id=e.objectId,this.createdAt=a._parseDate(e.createdAt),this.updatedAt=a._parseDate(e.updatedAt),this.messageId=e.messageId,delete e.messageId,delete e.objectId,delete e.createdAt,delete e.updatedAt,this.data=a._decode(void 0,e)}},a.Status.sendStatusToFollowers=function(t,e){if(!a.User.current())throw"Please signin an user.";var n={className:"_Follower",keys:"follower"},r=a.Object.createWithoutData("_User",a.User.current().id)._toPointer();n.where={user:r};var i={};return i.query=n,t.data=t.data||{},t.data.source=t.data.source||r,i.data=t._getDataJSON(),i.inboxType=t.inboxType||"default",a._request("statuses",null,null,"POST",i).then(function(e){return t.id=e.objectId,t.createdAt=a._parseDate(e.createdAt),t})._thenRunCallbacks(e)},a.Status.sendPrivateStatus=function(t,e,n){if(!a.User.current())throw"Please signin an user.";if(!e)throw"Invalid target user.";var r=u.isString(e)?e:e.id;if(!r)throw"Invalid target user.";var i={className:"_User"},s=a.Object.createWithoutData("_User",a.User.current().id)._toPointer();i.where={objectId:r};var o={};return o.query=i,t.data=t.data||{},t.data.source=t.data.source||s,o.data=t._getDataJSON(),o.inboxType="private",t.inboxType="private",a._request("statuses",null,null,"POST",o).then(function(e){return t.id=e.objectId,t.createdAt=a._parseDate(e.createdAt),t})._thenRunCallbacks(n)},a.Status.countUnreadStatuses=function(e){if(!a.User.current()&&null==e)throw"Please signin an user or pass the owner objectId.";e=e||a.User.current();var t=u.isString(arguments[1])?arguments[2]:arguments[1],n=u.isString(arguments[1])?arguments[1]:"default",r={};return r.inboxType=a._encode(n),r.owner=a._encode(e),a._request("subscribe/statuses/count",null,null,"GET",r)._thenRunCallbacks(t)},a.Status.statusQuery=function(e){var t=new a.Query("_Status");return e&&t.equalTo("source",e),t},a.InboxQuery=a.Query._extend({_objectClass:a.Status,_sinceId:0,_maxId:0,_inboxType:"default",_owner:null,_newObject:function(){return new a.Status},_createRequest:function(e){return a._request("subscribe/statuses",null,null,"GET",e||this.toJSON())},sinceId:function(e){return this._sinceId=e,this},maxId:function(e){return this._maxId=e,this},owner:function(e){return this._owner=e,this},inboxType:function(e){return this._inboxType=e,this},toJSON:function(){var e=a.InboxQuery.__super__.toJSON.call(this);return e.owner=a._encode(this._owner),e.inboxType=a._encode(this._inboxType),e.sinceId=a._encode(this._sinceId),e.maxId=a._encode(this._maxId),e}}),a.Status.inboxQuery=function(e,t){var n=new a.InboxQuery(a.Status);return e&&(n._owner=e),t&&(n._inboxType=t),n}}},{underscore:29}],23:[function(e,t){"use strict";var u=e("underscore");t.exports=function(a){a.User=a.Object.extend("_User",{_isCurrentUser:!1,_mergeMagicFields:function(e){e.sessionToken&&(this._sessionToken=e.sessionToken,delete e.sessionToken),a.User.__super__._mergeMagicFields.call(this,e)},_cleanupAuthData:function(){if(this.isCurrent()){var n=this.get("authData");n&&a._objectEach(this.get("authData"),function(e,t){n[t]||delete n[t]})}},_synchronizeAllAuthData:function(){if(this.get("authData")){var n=this;a._objectEach(this.get("authData"),function(e,t){n._synchronizeAuthData(t)})}},_synchronizeAuthData:function(e){if(this.isCurrent()){var t;u.isString(e)?(t=e,e=a.User._authProviders[t]):t=e.getAuthType();var n=this.get("authData");if(n&&e)e.restoreAuthentication(n[t])||this._unlinkFrom(e)}},_handleSaveResult:function(e){e&&(this._isCurrentUser=!0),this._cleanupAuthData(),this._synchronizeAllAuthData(),delete this._serverData.password,this._rebuildEstimatedDataForKey("password"),this._refreshCache(),(e||this.isCurrent())&&a.User._saveCurrentUser(this)},_linkWith:function(e,n){var t;if(u.isString(e)?(t=e,e=a.User._authProviders[e]):t=e.getAuthType(),u.has(n,"authData")){var r=this.get("authData")||{};r[t]=n.authData,this.set("authData",r);var i=u.clone(n)||{};return i.success=function(e){e._handleSaveResult(!0),n.success&&n.success.apply(this,arguments)},this.save({authData:r},i)}var s=this,o=new a.Promise;return e.authenticate({success:function(e,t){s._linkWith(e,{authData:t,success:n.success,error:n.error}).then(function(){o.resolve(s)})},error:function(e,t){n.error&&n.error(s,t),o.reject(t)}}),o},_unlinkFrom:function(e,t){u.isString(e)?e=a.User._authProviders[e]:e.getAuthType();var n=u.clone(t),r=this;return n.authData=null,n.success=function(){r._synchronizeAuthData(e),t.success&&t.success.apply(this,arguments)},this._linkWith(e,n)},_isLinked:function(e){var t;return t=u.isString(e)?e:e.getAuthType(),!!(this.get("authData")||{})[t]},_logOutWithAll:function(){if(this.get("authData")){var n=this;a._objectEach(this.get("authData"),function(e,t){n._logOutWith(t)})}},_logOutWith:function(e){this.isCurrent()&&(u.isString(e)&&(e=a.User._authProviders[e]),e&&e.deauthenticate&&e.deauthenticate())},signUp:function(e,t){var n;t=t||{};var r=e&&e.username||this.get("username");if(!r||""===r)return n=new a.Error(a.Error.OTHER_CAUSE,"Cannot sign up user with an empty name."),t&&t.error&&t.error(this,n),a.Promise.error(n);var i=e&&e.password||this.get("password");if(!i||""===i)return n=new a.Error(a.Error.OTHER_CAUSE,"Cannot sign up user with an empty password."),t&&t.error&&t.error(this,n),a.Promise.error(n);var s=u.clone(t);return s.success=function(e){e._handleSaveResult(!0),t.success&&t.success.apply(this,arguments)},this.save(e,s)},signUpOrlogInWithMobilePhone:function(e,t){var n;t=t||{};var r=e&&e.mobilePhoneNumber||this.get("mobilePhoneNumber");if(!r||""===r)return n=new a.Error(a.Error.OTHER_CAUSE,"Cannot sign up or login user by mobilePhoneNumber with an empty mobilePhoneNumber."),t&&t.error&&t.error(this,n),a.Promise.error(n);var i=e&&e.smsCode||this.get("smsCode");if(!i||""===i)return n=new a.Error(a.Error.OTHER_CAUSE,"Cannot sign up or login user by mobilePhoneNumber  with an empty smsCode."),t&&t.error&&t.error(this,n),a.Promise.error(n);var s=u.clone(t);return s._makeRequest=function(e,t,n,r,i){return a._request("usersByMobilePhone",null,null,"POST",i)},s.success=function(e){e._handleSaveResult(!0),delete e.attributes.smsCode,delete e._serverData.smsCode,t.success&&t.success.apply(this,arguments)},this.save(e,s)},logIn:function(e){var i=this;return a._request("login",null,null,"GET",this.toJSON()).then(function(e,t,n){var r=i.parse(e,t,n);return i._finishFetch(r),i._handleSaveResult(!0),r.smsCode||delete i.attributes.smsCode,i})._thenRunCallbacks(e,this)},save:function(e,t,n){var r,i;i=(i=u.isObject(e)||u.isNull(e)||u.isUndefined(e)?(r=e,t):((r={})[e]=t,n))||{};var s=u.clone(i);return s.success=function(e){e._handleSaveResult(!1),i.success&&i.success.apply(this,arguments)},a.Object.prototype.save.call(this,r,s)},follow:function(e,t){if(!this.id)throw"Please signin.";if(!e)throw"Invalid target user.";var n=u.isString(e)?e:e.id;if(!n)throw"Invalid target user.";var r="users/"+this.id+"/friendship/"+n;return a._request(r,null,null,"POST",null)._thenRunCallbacks(t)},unfollow:function(e,t){if(!this.id)throw"Please signin.";if(!e)throw"Invalid target user.";var n=u.isString(e)?e:e.id;if(!n)throw"Invalid target user.";var r="users/"+this.id+"/friendship/"+n;return a._request(r,null,null,"DELETE",null)._thenRunCallbacks(t)},followerQuery:function(){return a.User.followerQuery(this.id)},followeeQuery:function(){return a.User.followeeQuery(this.id)},fetch:function(t){var e=t?u.clone(t):{};return e.success=function(e){e._handleSaveResult(!1),t&&t.success&&t.success.apply(this,arguments)},a.Object.prototype.fetch.call(this,e)},updatePassword:function(e,t,n){var r="users/"+this.id+"/updatePassword",i={old_password:e,new_password:t};return a._request(r,null,null,"PUT",i)._thenRunCallbacks(n,this)},isCurrent:function(){return this._isCurrentUser},getUsername:function(){return this.get("username")},getMobilePhoneNumber:function(){return this.get("mobilePhoneNumber")},setMobilePhoneNumber:function(e,t){return this.set("mobilePhoneNumber",e,t)},setUsername:function(e,t){return this.set("username",e,t)},setPassword:function(e,t){return this.set("password",e,t)},getEmail:function(){return this.get("email")},setEmail:function(e,t){return this.set("email",e,t)},authenticated:function(){return!!this._sessionToken&&a.User.current()&&a.User.current().id===this.id}},{_currentUser:null,_currentUserMatchesDisk:!1,_CURRENT_USER_KEY:"currentUser",_authProviders:{},signUp:function(e,t,n,r){return(n=n||{}).username=e,n.password=t,a.Object._create("_User").signUp(n,r)},logIn:function(e,t,n){var r=a.Object._create("_User");return r._finishFetch({username:e,password:t}),r.logIn(n)},become:function(e,t){t=t||{};var i=a.Object._create("_User");return a._request("users","me",null,"GET",{useMasterKey:t.useMasterKey,session_token:e}).then(function(e,t,n){var r=i.parse(e,t,n);return i._finishFetch(r),i._handleSaveResult(!0),i})._thenRunCallbacks(t,i)},logInWithMobilePhoneSmsCode:function(e,t,n){var r=a.Object._create("_User");return r._finishFetch({mobilePhoneNumber:e,smsCode:t}),r.logIn(n)},signUpOrlogInWithMobilePhone:function(e,t,n,r){return(n=n||{}).mobilePhoneNumber=e,n.smsCode=t,a.Object._create("_User").signUpOrlogInWithMobilePhone(n,r)},logInWithMobilePhone:function(e,t,n){var r=a.Object._create("_User");return r._finishFetch({mobilePhoneNumber:e,password:t}),r.logIn(n)},logOut:function(){null!==a.User._currentUser&&(a.User._currentUser._logOutWithAll(),a.User._currentUser._isCurrentUser=!1),a.User._currentUserMatchesDisk=!0,a.User._currentUser=null,a.localStorage.removeItem(a._getAVPath(a.User._CURRENT_USER_KEY))},followerQuery:function(e){if(!e||!u.isString(e))throw"Invalid user object id.";var t=new a.FriendShipQuery("_Follower");return t._friendshipTag="follower",t.equalTo("user",a.Object.createWithoutData("_User",e)),t},followeeQuery:function(e){if(!e||!u.isString(e))throw"Invalid user object id.";var t=new a.FriendShipQuery("_Followee");return t._friendshipTag="followee",t.equalTo("user",a.Object.createWithoutData("_User",e)),t},requestPasswordReset:function(e,t){var n={email:e};return a._request("requestPasswordReset",null,null,"POST",n)._thenRunCallbacks(t)},requestEmailVerify:function(e,t){var n={email:e};return a._request("requestEmailVerify",null,null,"POST",n)._thenRunCallbacks(t)},requestEmailVerfiy:function(e,t){var n={email:e};return a._request("requestEmailVerify",null,null,"POST",n)._thenRunCallbacks(t)},requestMobilePhoneVerify:function(e,t){var n={mobilePhoneNumber:e};return a._request("requestMobilePhoneVerify",null,null,"POST",n)._thenRunCallbacks(t)},requestPasswordResetBySmsCode:function(e,t){var n={mobilePhoneNumber:e};return a._request("requestPasswordResetBySmsCode",null,null,"POST",n)._thenRunCallbacks(t)},resetPasswordBySmsCode:function(e,t,n){var r={password:t};return a._request("resetPasswordBySmsCode",null,e,"PUT",r)._thenRunCallbacks(n)},verifyMobilePhone:function(e,t){return a._request("verifyMobilePhone",null,e,"POST",null)._thenRunCallbacks(t)},requestLoginSmsCode:function(e,t){var n={mobilePhoneNumber:e};return a._request("requestLoginSmsCode",null,null,"POST",n)._thenRunCallbacks(t)},current:function(){if(a.User._currentUser)return a.User._currentUser;if(a.User._currentUserMatchesDisk)return a.User._currentUser;a.User._currentUserMatchesDisk=!0;var e=a.localStorage.getItem(a._getAVPath(a.User._CURRENT_USER_KEY));if(!e)return null;a.User._currentUser=a.Object._create("_User"),a.User._currentUser._isCurrentUser=!0;var t=JSON.parse(e);return a.User._currentUser.id=t._id,delete t._id,a.User._currentUser._sessionToken=t._sessionToken,delete t._sessionToken,a.User._currentUser._finishFetch(t),a.User._currentUser._synchronizeAllAuthData(),a.User._currentUser._refreshCache(),a.User._currentUser._opSetQueue=[{}],a.User._currentUser},_saveCurrentUser:function(e){a.User._currentUser!==e&&a.User.logOut(),e._isCurrentUser=!0,a.User._currentUser=e,a.User._currentUserMatchesDisk=!0;var t=e.toJSON();t._id=e.id,t._sessionToken=e._sessionToken,a.localStorage.setItem(a._getAVPath(a.User._CURRENT_USER_KEY),JSON.stringify(t))},_registerAuthenticationProvider:function(e){a.User._authProviders[e.getAuthType()]=e,a.User.current()&&a.User.current()._synchronizeAuthData(e.getAuthType())},_logInWith:function(e,t){return a.Object._create("_User")._linkWith(e,t)}})}},{underscore:29}],24:[function(e,t){(function(l){"use strict";e("underscore"),t.exports=function(c){"undefined"!=typeof $&&(c.$=$);function i(){}c.serverURL="https://avoscloud.com",void 0!==l&&l.versions&&l.versions.node&&(c._isNode=!0),c.initialize=function(e,t,n){if(n)throw new Error("AV.initialize() was passed a Master Key, which is only allowed from within Node.js.");c._initialize(e,t,n)},c._initialize=function(e,t,n){void 0!==c.applicationId&&e!==c.applicationId&&t!==c.applicationKey&&n!==c.masterKey&&console.warn("AVOSCloud SDK is already initialized, please don't reinitialize it."),c.applicationId=e,c.applicationKey=t,c.masterKey=n,c._useMasterKey=!1},c.setProduction=function(e){c._isNullOrUndefined(e)||(e=e?1:0),c.applicationProduction=c._isNullOrUndefined(e)?1:e},c._isNode&&(c.initialize=c._initialize,c.Cloud=c.Cloud||{},c.Cloud.useMasterKey=function(){c._useMasterKey=!0}),c.useAVCloudCN=function(){c.serverURL="https://leancloud.cn"},c.useAVCloudUS=function(){c.serverURL="https://us-api.leancloud.cn"},c._getAVPath=function(e){if(!c.applicationId)throw"You need to call AV.initialize before using AV.";if(e||(e=""),!c._.isString(e))throw"Tried to get a localStorage path that wasn't a String.";return"/"===e[0]&&(e=e.substring(1)),"AV/"+c.applicationId+"/"+e},c._installationId=null,c._getInstallationId=function(){if(c._installationId)return c._installationId;var e=c._getAVPath("installationId");if(c._installationId=c.localStorage.getItem(e),!c._installationId||""===c._installationId){var t=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};c._installationId=t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t(),c.localStorage.setItem(e,c._installationId)}return c._installationId},c._parseDate=function(e){var t=new RegExp("^([0-9]{1,4})-([0-9]{1,2})-([0-9]{1,2})T([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2})(.([0-9]+))?Z$").exec(e);if(!t)return null;var n=t[1]||0,r=(t[2]||1)-1,i=t[3]||0,s=t[4]||0,o=t[5]||0,a=t[6]||0,u=t[8]||0;return new Date(Date.UTC(n,r,i,s,o,a,u))},c._ajaxIE8=function(e,t,n){var r=new c.Promise,i=new XDomainRequest;return i.onload=function(){var e;try{e=JSON.parse(i.responseText)}catch(e){r.reject(e)}e&&r.resolve(e)},i.onerror=i.ontimeout=function(){JSON.stringify({code:c.Error.X_DOMAIN_REQUEST,error:"IE's XDomainRequest does not supply error info."}),r.reject(i)},i.onprogress=function(){},i.open(e,t),i.send(n),r},c._useXDomainRequest=function(){return"undefined"!=typeof XDomainRequest&&!("withCredentials"in new XMLHttpRequest)},c._ajax=function(e,t,n,r,i){var s={success:r,error:i};if(c._useXDomainRequest())return c._ajaxIE8(e,t,n)._thenRunCallbacks(s);var o=new c.Promise,a=!1,u=new c.XMLHttpRequest;return u.onreadystatechange=function(){if(4===u.readyState){if(a)return;if(a=!0,200<=u.status&&u.status<300){var e;try{e=JSON.parse(u.responseText)}catch(e){o.reject(e)}e&&o.resolve(e,u.status,u)}else o.reject(u)}},u.open(e,t,!0),u.setRequestHeader("Content-Type","text/plain"),c._isNode&&u.setRequestHeader("User-Agent","AV/"+c.VERSION+" (NodeJS "+l.versions.node+")"),u.send(n),o._thenRunCallbacks(s)},c._extend=function(e,t){var n=function(e,t,n){var r;return r=t&&t.hasOwnProperty("constructor")?t.constructor:function(){e.apply(this,arguments)},c._.extend(r,e),i.prototype=e.prototype,r.prototype=new i,t&&c._.extend(r.prototype,t),n&&c._.extend(r,n),(r.prototype.constructor=r).__super__=e.prototype,r}(this,e,t);return n.extend=this.extend,n},c._request=function(e,t,n,r,i){if(!c.applicationId)throw"You must specify your applicationId using AV.initialize";if(!c.applicationKey&&!c.masterKey)throw"You must specify a key using AV.initialize";if("batch"!==e&&"classes"!==e&&"files"!==e&&"date"!==e&&"functions"!==e&&"login"!==e&&"push"!==e&&"search/select"!==e&&"requestPasswordReset"!==e&&"requestEmailVerify"!==e&&"requestPasswordResetBySmsCode"!==e&&"resetPasswordBySmsCode"!==e&&"requestMobilePhoneVerify"!==e&&"requestLoginSmsCode"!==e&&"verifyMobilePhone"!==e&&"requestSmsCode"!==e&&"verifySmsCode"!==e&&"users"!==e&&"usersByMobilePhone"!==e&&"cloudQuery"!==e&&"qiniu"!==e&&"statuses"!==e&&"bigquery"!==e&&"search/select"!==e&&"subscribe/statuses/count"!==e&&"subscribe/statuses"!==e&&!/users\/[^\/]+\/updatePassword/.test(e)&&!/users\/[^\/]+\/friendship\/[^\/]+/.test(e))throw"Bad route: '"+e+"'.";var s=c.serverURL;"/"!==s.charAt(s.length-1)&&(s+="/"),s+="1.1/"+e,t&&(s+="/"+t),n&&(s+="/"+n),("users"===e||"classes"===e)&&i&&i._fetchWhenSave&&(delete i._fetchWhenSave,s+="?new=true"),i=c._.clone(i||{}),"POST"!==r&&(i._method=r,r="POST"),i._ApplicationId=c.applicationId,i._ApplicationKey=c.applicationKey,c._isNullOrUndefined(c.applicationProduction)||(i._ApplicationProduction=c.applicationProduction),c._useMasterKey&&(i._MasterKey=c.masterKey),i._ClientVersion=c.VERSION,i._InstallationId=c._getInstallationId();var o=c.User.current();o&&o._sessionToken&&(i._SessionToken=o._sessionToken);var a=JSON.stringify(i);return c._ajax(r,s,a).then(null,function(e){var t;if(e&&e.responseText)try{var n=JSON.parse(e.responseText);n&&(t=new c.Error(n.code,n.error))}catch(e){}return t=t||new c.Error(-1,e.responseText),c.Promise.error(t)})},c._getValue=function(e,t){return e&&e[t]?c._.isFunction(e[t])?e[t]():e[t]:null},c._encode=function(e,n,r){var t=c._;if(e instanceof c.Object){if(r)throw"AV.Objects not allowed here";if(!n||t.include(n,e)||!e._hasData)return e._toPointer();if(!e.dirty())return n=n.concat(e),c._encode(e._toFullJSON(n),n,r);throw"Tried to save an object with a pointer to a new, unsaved object."}if(e instanceof c.ACL)return e.toJSON();if(t.isDate(e))return{__type:"Date",iso:e.toJSON()};if(e instanceof c.GeoPoint)return e.toJSON();if(t.isArray(e))return t.map(e,function(e){return c._encode(e,n,r)});if(t.isRegExp(e))return e.source;if(e instanceof c.Relation)return e.toJSON();if(e instanceof c.Op)return e.toJSON();if(e instanceof c.File){if(!e.url()&&!e.id)throw"Tried to save an object containing an unsaved file.";return{__type:"File",id:e.id,name:e.name(),url:e.url()}}if(t.isObject(e)){var i={};return c._objectEach(e,function(e,t){i[t]=c._encode(e,n,r)}),i}return e},c._decode=function(e,n){var t=c._;if(!t.isObject(n))return n;if(t.isArray(n))return c._arrayEach(n,function(e,t){n[t]=c._decode(t,e)}),n;if(n instanceof c.Object)return n;if(n instanceof c.File)return n;if(n instanceof c.Op)return n;if(n.__op)return c.Op._decode(n);if("Pointer"===n.__type){var r=n.className,i=c.Object._create(r);return n.createdAt?(delete n.__type,delete n.className,i._finishFetch(n,!0)):i._finishFetch({objectId:n.objectId},!1),i}if("Object"===n.__type){r=n.className;delete n.__type,delete n.className;var s=c.Object._create(r);return s._finishFetch(n,!0),s}if("Date"===n.__type)return c._parseDate(n.iso);if("GeoPoint"===n.__type)return new c.GeoPoint({latitude:n.latitude,longitude:n.longitude});if("ACL"===e)return n instanceof c.ACL?n:new c.ACL(n);if("Relation"===n.__type){var o=new c.Relation(null,e);return o.targetClassName=n.className,o}if("File"!==n.__type)return c._objectEach(n,function(e,t){n[t]=c._decode(t,e)}),n;var a=new c.File(n.name);return a._metaData=n.metaData||{},a._url=n.url,a.id=n.objectId,a},c._arrayEach=c._.each,c._traverse=function(r,i,s){if(r instanceof c.Object){if(s=s||[],0<=c._.indexOf(s,r))return;return s.push(r),c._traverse(r.attributes,i,s),i(r)}return r instanceof c.Relation||r instanceof c.File||(c._.isArray(r)?c._.each(r,function(e,t){var n=c._traverse(e,i,s);n&&(r[t]=n)}):c._.isObject(r)&&c._each(r,function(e,t){var n=c._traverse(e,i,s);n&&(r[t]=n)})),i(r)},c._objectEach=c._each=function(t,n){var e=c._;e.isObject(t)?e.each(e.keys(t),function(e){n(t[e],e)}):e.each(t,n)},c._isNullOrUndefined=function(e){return c._.isNull(e)||c._.isUndefined(e)}}}).call(this,e("_process"))},{_process:27,underscore:29}],25:[function(e,t){"use strict";t.exports="js0.6.4"},{}],26:[function(e,t,c){(function(i){function s(e,t){for(var n=0,r=e.length-1;0<=r;r--){var i=e[r];"."===i?e.splice(r,1):".."===i?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;)e.unshift("..");return e}function o(e,t){if(e.filter)return e.filter(t);for(var n=[],r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n}function a(e){return t.exec(e).slice(1)}var t=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;c.resolve=function(){for(var e="",t=!1,n=arguments.length-1;-1<=n&&!t;n--){var r=0<=n?arguments[n]:i.cwd();if("string"!=typeof r)throw new TypeError("Arguments to path.resolve must be strings");r&&(e=r+"/"+e,t="/"===r.charAt(0))}return(t?"/":"")+(e=s(o(e.split("/"),function(e){return!!e}),!t).join("/"))||"."},c.normalize=function(e){var t=c.isAbsolute(e),n="/"===r(e,-1);return(e=s(o(e.split("/"),function(e){return!!e}),!t).join("/"))||t||(e="."),e&&n&&(e+="/"),(t?"/":"")+e},c.isAbsolute=function(e){return"/"===e.charAt(0)},c.join=function(){var e=Array.prototype.slice.call(arguments,0);return c.normalize(o(e,function(e){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},c.relative=function(e,t){function n(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;0<=n&&""===e[n];n--);return n<t?[]:e.slice(t,n-t+1)}e=c.resolve(e).substr(1),t=c.resolve(t).substr(1);for(var r=n(e.split("/")),i=n(t.split("/")),s=Math.min(r.length,i.length),o=s,a=0;a<s;a++)if(r[a]!==i[a]){o=a;break}var u=[];for(a=o;a<r.length;a++)u.push("..");return(u=u.concat(i.slice(o))).join("/")},c.sep="/",c.delimiter=":",c.dirname=function(e){var t=a(e),n=t[0],r=t[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},c.basename=function(e,t){var n=a(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},c.extname=function(e){return a(e)[3]};var r="b"==="ab".substr(-1)?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return t<0&&(t=e.length+t),e.substr(t,n)}}).call(this,e("_process"))},{_process:27}],27:[function(e,t){function n(){c=!1,o.length?u=o.concat(u):l=-1,u.length&&r()}function r(){if(!c){var e=setTimeout(n);c=!0;for(var t=u.length;t;){for(o=u,u=[];++l<t;)o[l].run();l=-1,t=u.length}o=null,c=!1,clearTimeout(e)}}function i(e,t){this.fun=e,this.array=t}function s(){}var o,a=t.exports={},u=[],c=!1,l=-1;a.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new i(e,t)),1!==u.length||c||setTimeout(r,0)},i.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=s,a.addListener=s,a.once=s,a.off=s,a.removeListener=s,a.removeAllListeners=s,a.emit=s,a.binding=function(){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},{}],28:[function(e,t,n){var r,i,s;r=this,s={},(i={}).length=0,i.getItem=function(e){return s[e]||null},i.setItem=function(e,t){void 0===t?i.removeItem(e):(s[e]=""+t,i.length++)},i.removeItem=function(e){delete s[e],i.length--},i.key=function(e){return Object.keys(s)[e]||null},i.clear=function(){s={},i.length=0},"object"==typeof n?t.exports=i:r.localStorageMemory=i},{}],29:[function(e,J,Q){(function(){function e(a){return function(e,t,n,r){t=b(t,r,4);var i=!j(e)&&g.keys(e),s=(i||e).length,o=0<a?0:s-1;return arguments.length<3&&(n=e[i?i[o]:o],o+=a),function(e,t,n,r,i,s){for(;0<=i&&i<s;i+=a){var o=r?r[i]:i;n=t(n,e[o],o,e)}return n}(e,t,n,i,o,s)}}function t(s){return function(e,t,n){t=y(t,n);for(var r=A(e),i=0<s?0:r-1;0<=i&&i<r;i+=s)if(t(e[i],i,e))return i;return-1}}function n(s,o,a){return function(e,t,n){var r=0,i=A(e);if("number"==typeof n)0<s?r=0<=n?n:Math.max(n+i,r):i=0<=n?Math.min(n+1,i):n+i+1;else if(a&&n&&i)return e[n=a(e,t)]===t?n:-1;if(t!=t)return 0<=(n=o(h.call(e,r,i),g.isNaN))?n+r:-1;for(n=0<s?r:i-1;0<=n&&n<i;n+=s)if(e[n]===t)return n;return-1}}function r(e,t){var n=I.length,r=e.constructor,i=g.isFunction(r)&&r.prototype||u,s="constructor";for(g.has(e,s)&&!g.contains(t,s)&&t.push(s);n--;)(s=I[n])in e&&e[s]!==i[s]&&!g.contains(t,s)&&t.push(s)}function i(){}var s=this,o=s._,a=Array.prototype,u=Object.prototype,c=Function.prototype,l=a.push,h=a.slice,f=u.toString,d=u.hasOwnProperty,p=Array.isArray,_=Object.keys,m=c.bind,v=Object.create,g=function(e){return e instanceof g?e:this instanceof g?void(this._wrapped=e):new g(e)};void 0!==Q?(void 0!==J&&J.exports&&(Q=J.exports=g),Q._=g):s._=g,g.VERSION="1.8.3";var b=function(i,s,e){if(void 0===s)return i;switch(null==e?3:e){case 1:return function(e){return i.call(s,e)};case 2:return function(e,t){return i.call(s,e,t)};case 3:return function(e,t,n){return i.call(s,e,t,n)};case 4:return function(e,t,n,r){return i.call(s,e,t,n,r)}}return function(){return i.apply(s,arguments)}},y=function(e,t,n){return null==e?g.identity:g.isFunction(e)?b(e,t,n):g.isObject(e)?g.matcher(e):g.property(e)};g.iteratee=function(e,t){return y(e,t,1/0)};function w(u,c){return function(e){var t=arguments.length;if(t<2||null==e)return e;for(var n=1;n<t;n++)for(var r=arguments[n],i=u(r),s=i.length,o=0;o<s;o++){var a=i[o];c&&void 0!==e[a]||(e[a]=r[a])}return e}}function O(e){if(!g.isObject(e))return{};if(v)return v(e);i.prototype=e;var t=new i;return i.prototype=null,t}function S(t){return function(e){return null==e?void 0:e[t]}}var x=Math.pow(2,53)-1,A=S("length"),j=function(e){var t=A(e);return"number"==typeof t&&0<=t&&t<=x};g.each=g.forEach=function(e,t,n){var r,i;if(t=b(t,n),j(e))for(r=0,i=e.length;r<i;r++)t(e[r],r,e);else{var s=g.keys(e);for(r=0,i=s.length;r<i;r++)t(e[s[r]],s[r],e)}return e},g.map=g.collect=function(e,t,n){t=y(t,n);for(var r=!j(e)&&g.keys(e),i=(r||e).length,s=Array(i),o=0;o<i;o++){var a=r?r[o]:o;s[o]=t(e[a],a,e)}return s},g.reduce=g.foldl=g.inject=e(1),g.reduceRight=g.foldr=e(-1),g.find=g.detect=function(e,t,n){var r;return void 0!==(r=j(e)?g.findIndex(e,t,n):g.findKey(e,t,n))&&-1!==r?e[r]:void 0},g.filter=g.select=function(e,r,t){var i=[];return r=y(r,t),g.each(e,function(e,t,n){r(e,t,n)&&i.push(e)}),i},g.reject=function(e,t,n){return g.filter(e,g.negate(y(t)),n)},g.every=g.all=function(e,t,n){t=y(t,n);for(var r=!j(e)&&g.keys(e),i=(r||e).length,s=0;s<i;s++){var o=r?r[s]:s;if(!t(e[o],o,e))return!1}return!0},g.some=g.any=function(e,t,n){t=y(t,n);for(var r=!j(e)&&g.keys(e),i=(r||e).length,s=0;s<i;s++){var o=r?r[s]:s;if(t(e[o],o,e))return!0}return!1},g.contains=g.includes=g.include=function(e,t,n,r){return j(e)||(e=g.values(e)),"number"==typeof n&&!r||(n=0),0<=g.indexOf(e,t,n)},g.invoke=function(e,n){var r=h.call(arguments,2),i=g.isFunction(n);return g.map(e,function(e){var t=i?n:e[n];return null==t?t:t.apply(e,r)})},g.pluck=function(e,t){return g.map(e,g.property(t))},g.where=function(e,t){return g.filter(e,g.matcher(t))},g.findWhere=function(e,t){return g.find(e,g.matcher(t))},g.max=function(e,r,t){var n,i,s=-1/0,o=-1/0;if(null==r&&null!=e)for(var a=0,u=(e=j(e)?e:g.values(e)).length;a<u;a++)n=e[a],s<n&&(s=n);else r=y(r,t),g.each(e,function(e,t,n){i=r(e,t,n),(o<i||i===-1/0&&s===-1/0)&&(s=e,o=i)});return s},g.min=function(e,r,t){var n,i,s=1/0,o=1/0;if(null==r&&null!=e)for(var a=0,u=(e=j(e)?e:g.values(e)).length;a<u;a++)(n=e[a])<s&&(s=n);else r=y(r,t),g.each(e,function(e,t,n){((i=r(e,t,n))<o||1/0===i&&1/0===s)&&(s=e,o=i)});return s},g.shuffle=function(e){for(var t,n=j(e)?e:g.values(e),r=n.length,i=Array(r),s=0;s<r;s++)(t=g.random(0,s))!==s&&(i[s]=i[t]),i[t]=n[s];return i},g.sample=function(e,t,n){return null==t||n?(j(e)||(e=g.values(e)),e[g.random(e.length-1)]):g.shuffle(e).slice(0,Math.max(0,t))},g.sortBy=function(e,r,t){return r=y(r,t),g.pluck(g.map(e,function(e,t,n){return{value:e,index:t,criteria:r(e,t,n)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(r<n||void 0===n)return 1;if(n<r||void 0===r)return-1}return e.index-t.index}),"value")};function E(o){return function(r,i,e){var s={};return i=y(i,e),g.each(r,function(e,t){var n=i(e,t,r);o(s,e,n)}),s}}g.groupBy=E(function(e,t,n){g.has(e,n)?e[n].push(t):e[n]=[t]}),g.indexBy=E(function(e,t,n){e[n]=t}),g.countBy=E(function(e,t,n){g.has(e,n)?e[n]++:e[n]=1}),g.toArray=function(e){return e?g.isArray(e)?h.call(e):j(e)?g.map(e,g.identity):g.values(e):[]},g.size=function(e){return null==e?0:j(e)?e.length:g.keys(e).length},g.partition=function(e,r,t){r=y(r,t);var i=[],s=[];return g.each(e,function(e,t,n){(r(e,t,n)?i:s).push(e)}),[i,s]},g.first=g.head=g.take=function(e,t,n){return null==e?void 0:null==t||n?e[0]:g.initial(e,e.length-t)},g.initial=function(e,t,n){return h.call(e,0,Math.max(0,e.length-(null==t||n?1:t)))},g.last=function(e,t,n){return null==e?void 0:null==t||n?e[e.length-1]:g.rest(e,Math.max(0,e.length-t))},g.rest=g.tail=g.drop=function(e,t,n){return h.call(e,null==t||n?1:t)},g.compact=function(e){return g.filter(e,g.identity)};var N=function(e,t,n,r){for(var i=[],s=0,o=r||0,a=A(e);o<a;o++){var u=e[o];if(j(u)&&(g.isArray(u)||g.isArguments(u))){t||(u=N(u,t,n));var c=0,l=u.length;for(i.length+=l;c<l;)i[s++]=u[c++]}else n||(i[s++]=u)}return i};g.flatten=function(e,t){return N(e,t,!1)},g.without=function(e){return g.difference(e,h.call(arguments,1))},g.uniq=g.unique=function(e,t,n,r){g.isBoolean(t)||(r=n,n=t,t=!1),null!=n&&(n=y(n,r));for(var i=[],s=[],o=0,a=A(e);o<a;o++){var u=e[o],c=n?n(u,o,e):u;t?(o&&s===c||i.push(u),s=c):n?g.contains(s,c)||(s.push(c),i.push(u)):g.contains(i,u)||i.push(u)}return i},g.union=function(){return g.uniq(N(arguments,!0,!0))},g.intersection=function(e){for(var t=[],n=arguments.length,r=0,i=A(e);r<i;r++){var s=e[r];if(!g.contains(t,s)){for(var o=1;o<n&&g.contains(arguments[o],s);o++);o===n&&t.push(s)}}return t},g.difference=function(e){var t=N(arguments,!0,!0,1);return g.filter(e,function(e){return!g.contains(t,e)})},g.zip=function(){return g.unzip(arguments)},g.unzip=function(e){for(var t=e&&g.max(e,A).length||0,n=Array(t),r=0;r<t;r++)n[r]=g.pluck(e,r);return n},g.object=function(e,t){for(var n={},r=0,i=A(e);r<i;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},g.findIndex=t(1),g.findLastIndex=t(-1),g.sortedIndex=function(e,t,n,r){for(var i=(n=y(n,r,1))(t),s=0,o=A(e);s<o;){var a=Math.floor((s+o)/2);n(e[a])<i?s=a+1:o=a}return s},g.indexOf=n(1,g.findIndex,g.sortedIndex),g.lastIndexOf=n(-1,g.findLastIndex),g.range=function(e,t,n){null==t&&(t=e||0,e=0),n=n||1;for(var r=Math.max(Math.ceil((t-e)/n),0),i=Array(r),s=0;s<r;s++,e+=n)i[s]=e;return i};function C(e,t,n,r,i){if(!(r instanceof t))return e.apply(n,i);var s=O(e.prototype),o=e.apply(s,i);return g.isObject(o)?o:s}g.bind=function(e,t){if(m&&e.bind===m)return m.apply(e,h.call(arguments,1));if(!g.isFunction(e))throw new TypeError("Bind must be called on a function");var n=h.call(arguments,2),r=function(){return C(e,r,t,this,n.concat(h.call(arguments)))};return r},g.partial=function(i){var s=h.call(arguments,1),o=function(){for(var e=0,t=s.length,n=Array(t),r=0;r<t;r++)n[r]=s[r]===g?arguments[e++]:s[r];for(;e<arguments.length;)n.push(arguments[e++]);return C(i,o,this,this,n)};return o},g.bindAll=function(e){var t,n,r=arguments.length;if(r<=1)throw new Error("bindAll must be passed function names");for(t=1;t<r;t++)e[n=arguments[t]]=g.bind(e[n],e);return e},g.memoize=function(r,i){var s=function(e){var t=s.cache,n=""+(i?i.apply(this,arguments):e);return g.has(t,n)||(t[n]=r.apply(this,arguments)),t[n]};return s.cache={},s},g.delay=function(e,t){var n=h.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},g.defer=g.partial(g.delay,g,1),g.throttle=function(n,r,i){var s,o,a,u=null,c=0;i||(i={});function l(){c=!1===i.leading?0:g.now(),u=null,a=n.apply(s,o),u||(s=o=null)}return function(){var e=g.now();c||!1!==i.leading||(c=e);var t=r-(e-c);return s=this,o=arguments,t<=0||r<t?(u&&(clearTimeout(u),u=null),c=e,a=n.apply(s,o),u||(s=o=null)):u||!1===i.trailing||(u=setTimeout(l,t)),a}},g.debounce=function(t,n,r){var i,s,o,a,u,c=function(){var e=g.now()-a;e<n&&0<=e?i=setTimeout(c,n-e):(i=null,r||(u=t.apply(o,s),i||(o=s=null)))};return function(){o=this,s=arguments,a=g.now();var e=r&&!i;return i||(i=setTimeout(c,n)),e&&(u=t.apply(o,s),o=s=null),u}},g.wrap=function(e,t){return g.partial(t,e)},g.negate=function(e){return function(){return!e.apply(this,arguments)}},g.compose=function(){var n=arguments,r=n.length-1;return function(){for(var e=r,t=n[r].apply(this,arguments);e--;)t=n[e].call(this,t);return t}},g.after=function(e,t){return function(){return--e<1?t.apply(this,arguments):void 0}},g.before=function(e,t){var n;return function(){return 0<--e&&(n=t.apply(this,arguments)),e<=1&&(t=null),n}},g.once=g.partial(g.before,2);var R=!{toString:null}.propertyIsEnumerable("toString"),I=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];g.keys=function(e){if(!g.isObject(e))return[];if(_)return _(e);var t=[];for(var n in e)g.has(e,n)&&t.push(n);return R&&r(e,t),t},g.allKeys=function(e){if(!g.isObject(e))return[];var t=[];for(var n in e)t.push(n);return R&&r(e,t),t},g.values=function(e){for(var t=g.keys(e),n=t.length,r=Array(n),i=0;i<n;i++)r[i]=e[t[i]];return r},g.mapObject=function(e,t,n){t=y(t,n);for(var r,i=g.keys(e),s=i.length,o={},a=0;a<s;a++)o[r=i[a]]=t(e[r],r,e);return o},g.pairs=function(e){for(var t=g.keys(e),n=t.length,r=Array(n),i=0;i<n;i++)r[i]=[t[i],e[t[i]]];return r},g.invert=function(e){for(var t={},n=g.keys(e),r=0,i=n.length;r<i;r++)t[e[n[r]]]=n[r];return t},g.functions=g.methods=function(e){var t=[];for(var n in e)g.isFunction(e[n])&&t.push(n);return t.sort()},g.extend=w(g.allKeys),g.extendOwn=g.assign=w(g.keys),g.findKey=function(e,t,n){t=y(t,n);for(var r,i=g.keys(e),s=0,o=i.length;s<o;s++)if(t(e[r=i[s]],r,e))return r},g.pick=function(e,t,n){var r,i,s={},o=e;if(null==o)return s;g.isFunction(t)?(i=g.allKeys(o),r=b(t,n)):(i=N(arguments,!1,!1,1),r=function(e,t,n){return t in n},o=Object(o));for(var a=0,u=i.length;a<u;a++){var c=i[a],l=o[c];r(l,c,o)&&(s[c]=l)}return s},g.omit=function(e,t,n){if(g.isFunction(t))t=g.negate(t);else{var r=g.map(N(arguments,!1,!1,1),String);t=function(e,t){return!g.contains(r,t)}}return g.pick(e,t,n)},g.defaults=w(g.allKeys,!0),g.create=function(e,t){var n=O(e);return t&&g.extendOwn(n,t),n},g.clone=function(e){return g.isObject(e)?g.isArray(e)?e.slice():g.extend({},e):e},g.tap=function(e,t){return t(e),e},g.isMatch=function(e,t){var n=g.keys(t),r=n.length;if(null==e)return!r;for(var i=Object(e),s=0;s<r;s++){var o=n[s];if(t[o]!==i[o]||!(o in i))return!1}return!0};var P=function(e,t,n,r){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof g&&(e=e._wrapped),t instanceof g&&(t=t._wrapped);var i=f.call(e);if(i!==f.call(t))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:0==+e?1/+e==1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t}var s="[object Array]"===i;if(!s){if("object"!=typeof e||"object"!=typeof t)return!1;var o=e.constructor,a=t.constructor;if(o!==a&&!(g.isFunction(o)&&o instanceof o&&g.isFunction(a)&&a instanceof a)&&"constructor"in e&&"constructor"in t)return!1}r=r||[];for(var u=(n=n||[]).length;u--;)if(n[u]===e)return r[u]===t;if(n.push(e),r.push(t),s){if((u=e.length)!==t.length)return!1;for(;u--;)if(!P(e[u],t[u],n,r))return!1}else{var c,l=g.keys(e);if(u=l.length,g.keys(t).length!==u)return!1;for(;u--;)if(c=l[u],!g.has(t,c)||!P(e[c],t[c],n,r))return!1}return n.pop(),r.pop(),!0};g.isEqual=function(e,t){return P(e,t)},g.isEmpty=function(e){return null==e||(j(e)&&(g.isArray(e)||g.isString(e)||g.isArguments(e))?0===e.length:0===g.keys(e).length)},g.isElement=function(e){return!(!e||1!==e.nodeType)},g.isArray=p||function(e){return"[object Array]"===f.call(e)},g.isObject=function(e){var t=typeof e;return"function"==t||"object"==t&&!!e},g.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(t){g["is"+t]=function(e){return f.call(e)==="[object "+t+"]"}}),g.isArguments(arguments)||(g.isArguments=function(e){return g.has(e,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(g.isFunction=function(e){return"function"==typeof e||!1}),g.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},g.isNaN=function(e){return g.isNumber(e)&&e!==+e},g.isBoolean=function(e){return!0===e||!1===e||"[object Boolean]"===f.call(e)},g.isNull=function(e){return null===e},g.isUndefined=function(e){return void 0===e},g.has=function(e,t){return null!=e&&d.call(e,t)},g.noConflict=function(){return s._=o,this},g.identity=function(e){return e},g.constant=function(e){return function(){return e}},g.noop=function(){},g.property=S,g.propertyOf=function(t){return null==t?function(){}:function(e){return t[e]}},g.matcher=g.matches=function(t){return t=g.extendOwn({},t),function(e){return g.isMatch(e,t)}},g.times=function(e,t,n){var r=Array(Math.max(0,e));t=b(t,n,1);for(var i=0;i<e;i++)r[i]=t(i);return r},g.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},g.now=Date.now||function(){return(new Date).getTime()};function T(t){function n(e){return t[e]}var e="(?:"+g.keys(t).join("|")+")",r=RegExp(e),i=RegExp(e,"g");return function(e){return e=null==e?"":""+e,r.test(e)?e.replace(i,n):e}}var U={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},k=g.invert(U);g.escape=T(U),g.unescape=T(k),g.result=function(e,t,n){var r=null==e?void 0:e[t];return void 0===r&&(r=n),g.isFunction(r)?r.call(e):r};var D=0;g.uniqueId=function(e){var t=++D+"";return e?e+t:t},g.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};function q(e){return"\\"+M[e]}var L=/(.)^/,M={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},F=/\\|'|\r|\n|\u2028|\u2029/g;g.template=function(s,e,t){!e&&t&&(e=t),e=g.defaults({},e,g.templateSettings);var n=RegExp([(e.escape||L).source,(e.interpolate||L).source,(e.evaluate||L).source].join("|")+"|$","g"),o=0,a="__p+='";s.replace(n,function(e,t,n,r,i){return a+=s.slice(o,i).replace(F,q),o=i+e.length,t?a+="'+\n((__t=("+t+"))==null?'':_.escape(__t))+\n'":n?a+="'+\n((__t=("+n+"))==null?'':__t)+\n'":r&&(a+="';\n"+r+"\n__p+='"),e}),a+="';\n",e.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{var r=new Function(e.variable||"obj","_",a)}catch(e){throw e.source=a,e}function i(e){return r.call(this,e,g)}var u=e.variable||"obj";return i.source="function("+u+"){\n"+a+"}",i},g.chain=function(e){var t=g(e);return t._chain=!0,t};function V(e,t){return e._chain?g(t).chain():t}g.mixin=function(n){g.each(g.functions(n),function(e){var t=g[e]=n[e];g.prototype[e]=function(){var e=[this._wrapped];return l.apply(e,arguments),V(this,t.apply(g,e))}})},g.mixin(g),g.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var n=a[t];g.prototype[t]=function(){var e=this._wrapped;return n.apply(e,arguments),"shift"!==t&&"splice"!==t||0!==e.length||delete e[0],V(this,e)}}),g.each(["concat","join","slice"],function(e){var t=a[e];g.prototype[e]=function(){return V(this,t.apply(this._wrapped,arguments))}}),g.prototype.value=function(){return this._wrapped},g.prototype.valueOf=g.prototype.toJSON=g.prototype.value,g.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return g})}).call(this)},{}]},{},[2]);